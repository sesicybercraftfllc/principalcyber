<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cybercraft</title>
    <style>
        /* PALETA DE CORES TERROSAS */
        :root {
            --cor-background: #f7f4e9; /* Bege claro / Off-White */
            --cor-principal: #6b4423;    /* Marrom Caf√© */
            --cor-secundaria: #8b5e34;  /* Marrom M√©dio */
            --cor-borda: #d4c7b2;        /* Bege acinzentado */
            --cor-texto-principal: #333;
            --cor-destaque-usuario: #4a784d; /* Verde Musgo */
            --cor-destaque-dev: #e0c29a;      /* Ocre/Bege Quente */
            --cor-erro: #cc0000; /* Cor Vermelha para Erro */
        }
       
        body {    
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;    
            margin: 0;    
            padding: 20px;
            background-color: var(--cor-background);    
            color: var(--cor-texto-principal);
        }
        .container {    
            max-width: 900px;    
            margin: 0 auto;    
            background-color: #fff;    
            padding: 30px;    
            border-radius: 12px;    
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        h1 {    
            text-align: center;    
            color: var(--cor-principal);    
            border-bottom: 2px solid var(--cor-borda);    
            padding-bottom: 10px;
        }
        h2, h3 { color: var(--cor-secundaria);
        }
       
        /* Formul√°rios e Pain√©is */
        #login-form, #dev-panel {    
            margin-top: 20px;    
            padding: 20px;    
            border: 1px solid var(--cor-borda);    
            border-radius: 8px;    
            background-color: #ffffff;
        }
        /* Estilo para input[text], input[password] e textarea */
        #login-form input[type="text"], #login-form input[type="password"],
        #dev-panel input[type="text"], #dev-panel select, #item-file,
        #edit-modal input[type="text"], #edit-modal select {    
            padding: 10px;    
            margin-bottom: 12px;    
            width: 100%;    
            box-sizing: border-box;    
            border: 1px solid var(--cor-borda);
            border-radius: 4px;
        }
        /* Bot√£o de Arquivo */
        #item-file { padding: 5px;
        }

        /* Bot√µes */
        button {    
            padding: 10px 15px;    
            border: none;    
            border-radius: 4px;    
            cursor: pointer;    
            transition: background-color 0.3s;
        }
       
        /* Bot√£o Desenvolvedor */
        #login-form button {    
            background-color: var(--cor-principal);    
            color: white;    
            width: 100%;
        }
        #login-form button:hover { background-color: #4a2f1c;
        }

        /* Bot√£o Usu√°rio (M√ÅXIMO DE DESTAQUE) */
        #login-section > button {    
            background-color: var(--cor-destaque-usuario); /* Verde Musgo */
            color: white;
            width: 100%;
            margin-top: 15px;
            font-size: 1.3em; /* Mais destaque */
            padding: 18px; /* Mais preenchimento */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* Sombra mais forte */
            font-weight: bold;
        }
        #login-section > button:hover {    
            background-color: #3b603e;    
            transform: translateY(-2px); /* Efeito sutil ao passar o mouse */
        }

        /* Bot√µes Sair e A√ß√µes Dev */
        #dev-panel button, #user-view button {    
            background-color: var(--cor-secundaria);    
            color: white;
        }
        #dev-panel button:hover, #user-view button:hover { background-color: var(--cor-principal);
        }
       
        /* Estilo dos Links/Arquivos */
        .file-item a { color: var(--cor-principal); text-decoration: none; font-weight: bold;}
        .file-item a:hover { text-decoration: underline;
        }
        .dev-info { font-size: 0.85em; color: var(--cor-secundaria); margin-top: 5px;
        }

        /* Visualiza√ß√£o do Usu√°rio */
        #user-view h2 { color: var(--cor-destaque-usuario);
        }
        .file-item {    
            border: 1px solid var(--cor-borda);    
            padding: 15px;    
            margin-bottom: 10px;    
            border-radius: 6px;    
            background-color: #fffaf0;    
        }
        /* Novo estilo para o t√≠tulo do item */
        .file-item h4 {
            margin-top: 0;
            margin-bottom: 10px;
            color: var(--cor-principal);
            font-size: 1.2em;
        }
        .file-item img, .file-item video { max-width: 100%; height: auto; border-radius: 4px; margin-top: 10px; }
       
        /* NOVO: Painel de Informa√ß√µes da HOME */
        .info-panel {
            padding: 30px;
            background-color: #ffffff;
            border: 3px solid var(--cor-principal);
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
        }
        .info-panel h2 {
            color: var(--cor-principal);
            font-size: 1.8em;
            margin-bottom: 10px;
        }
        .info-panel h3 {
             color: var(--cor-secundaria);
             margin-top: 15px;
        }

        /* Mensagem de Conscientiza√ß√£o */
        .message {
            font-size: 1em;
            text-align: justify;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid var(--cor-borda);
            border-radius: 8px;
            background-color: #ffffff;
            line-height: 1.5;
        }

        /* Sem√°foro da Arqueologia */
        .semaforo-container {
            display: flex;
            justify-content: space-around;
            gap: 15px;
            margin: 30px 0;
            padding: 20px 0;
            border-top: 1px solid var(--cor-secundaria);
            border-bottom: 1px solid var(--cor-secundaria);
        }
        .semaforo-item {
            width: 30%;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            text-align: center;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            padding: 10px;
            font-size: 1.1em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
            transition: transform 0.2s;
        }
        .semaforo-item:hover {
             transform: translateY(-3px);
        }
        .semaforo-vermelho { background-color: #cc0000;
        }    
        .semaforo-amarelo {    
            background-color: #ffc400;    
            color: var(--cor-principal);    
            text-shadow: none;
        }    
        .semaforo-verde { background-color: var(--cor-destaque-usuario);
        }    

        /* Estilos para o Quiz (Paginado) */
        .quiz-container {
            margin-top: 30px;
            padding: 20px;
            border: 1px solid var(--cor-secundaria);    
            border-radius: 8px;
            background-color: var(--cor-background);    
            text-align: left;
        }
        .quiz-question {
            font-weight: bold;
            color: var(--cor-principal);
            margin-bottom: 15px;
            padding-top: 15px;
            border-top: 1px dotted var(--cor-borda);
        }
        .quiz-option {
            margin-bottom: 8px;
            cursor: pointer;
            padding: 10px;
            border-radius: 4px;
            transition: background-color 0.2s;
            border: 1px solid var(--cor-borda); /* Borda padr√£o */
            background-color: #ffffff;
        }
        .quiz-option:hover {
            background-color: #e0d9c9;
        }
        .quiz-option.selected {
            background-color: #d1e7dd; /* Fundo mais claro para sele√ß√£o ativa */
            border: 1px solid var(--cor-destaque-usuario);
        }
        .quiz-option.selected:hover {
            background-color: #d1e7dd;
        }

        .quiz-result {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px solid var(--cor-borda);
            font-weight: bold;
            text-align: center;
        }
        /* Cores de feedback ap√≥s o envio */
        .quiz-option.correct {
            background-color: #e6ffe6 !important; /* Fundo Verde muito claro (importante para sobrescrever) */
            border: 1px solid var(--cor-destaque-usuario) !important;
        }
        .quiz-option.incorrect {
            background-color: #ffe6e6 !important; /* Fundo Vermelho muito claro */
            border: 1px solid var(--cor-erro) !important;
        }
        .quiz-option.correct:hover, .quiz-option.incorrect:hover {
            background-color: initial;
            cursor: default;
        }

        /* Estilos para o Dashboard da Home (2 COLUNAS) */
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
            margin-bottom: 20px;
        }
       
        .dashboard-card {
            background-color: #ffffff;
            border: 2px solid var(--cor-destaque-usuario);
            border-radius: 8px;
            padding: 15px;
            text-align: center;
            transition: transform 0.2s, box-shadow 0.2s;
            text-decoration: none;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            min-height: 150px;
            overflow: hidden;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.2);
        }

        /* √çcone (para Links e V√≠deos) */
        .dashboard-card .card-icon {
            font-size: 2.8em;
            margin-bottom: 10px;
        }

        /* Imagem de Pr√©-visualiza√ß√£o (para Fotos) */
        .card-image-preview {
            max-width: 100%;
            max-height: 100px; /* Limita a altura para uniformidade */
            width: auto;
            object-fit: contain; /* Garante que a imagem se ajuste sem cortar */
            margin: 0 auto 10px auto; /* Centraliza e adiciona margem */
            border-radius: 4px;
        }

        .dashboard-card .card-name {
            font-weight: bold;
            color: var(--cor-principal);
            font-size: 1.1em;
            margin-bottom: 5px;
        }

        .dashboard-card .card-type {
            font-size: 0.8em;
            color: var(--cor-secundaria);
            opacity: 0.9;
        }
       
        /* NOVO: Informa√ß√£o do Desenvolvedor no Card */
        .dashboard-card .card-dev-info {
            font-size: 0.75em;
            color: var(--cor-secundaria); /* Marrom M√©dio */
            margin-top: 5px;
            opacity: 0.8;
        }


        /* Painel do Desenvolvedor */
        .dev-item {    
            display: flex;    
            justify-content: space-between;    
            align-items: center;    
            border: 1px solid var(--cor-destaque-dev);    
            padding: 10px;    
            margin-bottom: 10px;    
            border-radius: 6px;    
            background-color: var(--cor-destaque-dev);    
            color: var(--cor-principal); /* Garante que o item fique alinhado com o checkbox */
        }
        .dev-item input[type="checkbox"] {
            transform: scale(1.3); /* Aumenta o checkbox */
            margin-right: 15px;
        }
        .dev-item > span {
            flex-grow: 1; /* Permite que o conte√∫do principal ocupe o espa√ßo */
            width: auto;
        }
        .dev-item > div { display: flex; gap: 5px; flex-shrink: 0;
        } /* Estilo dos bot√µes Dev */

        .folder-selector { margin-bottom: 20px;
        }
        .folder-selector button {
            background-color: var(--cor-borda);
            color: var(--cor-texto-principal);
            margin-right: 5px;
        }
        .folder-selector button.active {
            background-color: var(--cor-principal);
            color: white;
            font-weight: bold;
        }
       
        /* Estilos para a nova tela de V√≠deos */
        #videos-screen {
            padding: 20px;
            border: 1px solid var(--cor-destaque-usuario);
            border-radius: 8px;
            background-color: #ffffff;
            margin-top: 20px;
        }

        /* Estilo para v√≠deos externos */
        .video-item a {
            display: block;
            padding: 10px;
            background-color: #f0f0f0;
            border: 1px solid var(--cor-borda);
            margin-bottom: 10px;
            text-align: center;
            font-weight: bold;
        }

        /* Estilos para o Painel de Chat/Feedback */
        #chat-panel {
            margin-top: 30px;
            padding: 20px;
            border: 1px solid var(--cor-principal);
            border-radius: 8px;
            background-color: #f7f4e9; /* Bege claro */
            color: var(--cor-texto-principal);
        }
        #chat-panel h2, #chat-panel h3 {
            color: var(--cor-principal);
            border-bottom: 1px dotted var(--cor-borda);
            padding-bottom: 10px;
        }
        .chat-messages {
            max-height: 400px;
            overflow-y: auto;
            padding: 10px;
            background-color: #ffffff;
            border: 1px solid var(--cor-borda);
            border-radius: 4px;
            margin-bottom: 15px;
        }
        /* NOVO: Estilo para o item de mensagem (para alinhamento do checkbox) */
        .message-item {
            padding: 8px;
            margin-bottom: 8px;
            border-radius: 6px;
            line-height: 1.4;
            display: flex; /* Para alinhar o checkbox com o texto */
            align-items: flex-start;
        }
        /* Checkbox do Dev no Chat */
        .message-item input[type="checkbox"] {
            margin-right: 15px;
            margin-top: 3px;
            transform: scale(1.1);
        }
        .user-message {
            background-color: #f0f8ff; /* Fundo Azul claro */
            border-left: 3px solid var(--cor-destaque-usuario);
            color: var(--cor-texto-principal);
            text-align: left;
        }
        .dev-reply {
            background-color: var(--cor-destaque-dev); /* Ocre/Bege Quente */
            border-right: 3px solid var(--cor-principal);
            text-align: right;
            color: var(--cor-principal);
        }
        /* NOVO: Div do Conte√∫do da Mensagem (para o Dev Reply) */
        .dev-reply > div {
             flex-grow: 1; /* Permite que o conte√∫do ocupe todo o espa√ßo */
        }
        .message-meta {
            font-size: 0.75em;
            color: #888;
            margin-top: 5px;
            display: block;
        }
        .dev-reply .message-meta {
            color: var(--cor-secundaria);
        }
        #chat-input-area {
            display: flex;
            gap: 10px;
        }
        #chat-input-area input {
            flex-grow: 1;
            margin-bottom: 0 !important; /* Sobrescrever o estilo global */
        }
        #chat-input-area button {
            width: 100px;
            flex-shrink: 0;
            background-color: var(--cor-principal);
            color: white;
        }
       
        /* Estilos para o Modal de Edi√ß√£o/Quick View/Termos */
        .modal {
            display: none;
            position: fixed;
            z-index: 10;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
        }

        .modal-content {
            background-color: var(--cor-background);
            margin: 10% auto;
            padding: 20px;
            border: 1px solid var(--cor-principal);
            width: 80%;
            max-width: 500px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
        }
        /* Quick View Modal (Sugest√£o 3) */
        #media-viewer-modal .modal-content {
             max-width: 700px; /* Maior para m√≠dia */
             margin: 5% auto;
             text-align: center;
             padding: 0; /* Remove padding para a m√≠dia */
             background-color: #000; /* Fundo escuro para m√≠dia */
        }
        #media-viewer-modal .modal-content img,
        #media-viewer-modal .modal-content video {
             max-width: 100%;
             max-height: 80vh; /* Limite a altura da tela */
             display: block;
             margin: 0 auto;
        }
        #media-viewer-modal .close-button {
             color: white;
             text-shadow: 0 0 5px black;
             position: absolute;
             top: 10px;
             right: 20px;
        }

        .close-button {
            color: var(--cor-principal);
            float: right;
            font-size: 28px;
            font-weight: bold;
        }

        .close-button:hover,
        .close-button:focus {
            color: #000;
            text-decoration: none;
            cursor: pointer;
        }
       
        #edit-modal h3 {
             color: var(--cor-principal);
             border-bottom: 1px solid var(--cor-borda);
             padding-bottom: 10px;
        }
        #edit-modal button {
             background-color: var(--cor-destaque-usuario);
             width: 100%;
             margin-top: 10px;
        }
       
        /* Controles de Busca e Filtro de Usu√°rio */
        #user-controls {
            margin-bottom: 20px; /* Flexbox ser√° manipulado no JS */
        }
        #search-container {
             position: relative; /* Para posicionar o autocomplete */
             flex-grow: 1;
        }
        #search-input {
            width: 100%;
            padding: 10px;
            border: 1px solid var(--cor-borda);
            border-radius: 4px;
            box-sizing: border-box; /* Garante que o padding n√£o estoure o width */
        }
        #sort-select {
            padding: 10px;
            border: 1px solid var(--cor-borda);
            border-radius: 4px;
        }
       
        /* Sugest√£o 6: Estilo para o Autocomplete */
        #search-suggestions {
            position: absolute;
            z-index: 9;
            width: 100%;
            max-height: 200px;
            overflow-y: auto;
            background: white;
            border: 1px solid var(--cor-principal);
            border-top: none;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        .suggestion-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid #eee;
        }
        .suggestion-item:hover {
            background-color: #f0f0f0;
        }
       
        /* Sugest√£o 2: Estilos para o Filtro de Tipo */
        #file-type-filters {
             margin-top: 15px;
             display: flex;
             gap: 10px;
             flex-wrap: wrap; /* Permite quebra de linha em telas pequenas */
        }
        #file-type-filters button {
            background-color: var(--cor-borda);
            color: var(--cor-texto-principal);
            padding: 8px 12px;
            border-radius: 4px;
        }
        #file-type-filters button.active {
            background-color: var(--cor-destaque-usuario);
            color: white;
            font-weight: bold;
        }
       
        /* Filtro de Chat do Desenvolvedor */
        #dev-chat-controls {
            margin-bottom: 15px;
            display: flex; /* Adiciona flex para alinhar o filtro e o bot√£o de exclus√£o */
            justify-content: flex-end; /* Alinha os itens √† direita */
            gap: 10px;
            align-items: center;
        }
       
        /* Controles de Exclus√£o em Massa de Chat */
        #chat-bulk-actions {
             margin-bottom: 10px;
             padding: 5px;
             border-bottom: 1px solid var(--cor-borda);
             display: flex;
             justify-content: space-between;
             align-items: center;
        }
        #chat-bulk-actions button {
            padding: 8px 12px;
        }
       
        /* Estilo do bot√£o de Curtida e Compartilhamento */
        .item-actions {
             display: flex;
             justify-content: flex-end;
             gap: 10px;
             margin-top: 10px;
             border-top: 1px dotted var(--cor-borda);
             padding-top: 5px;
        }
        .like-button, .share-button {
            background-color: #f0f0f0;
            color: var(--cor-principal);
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.9em;
            transition: background-color 0.2s;
        }
        .like-button:hover, .share-button:hover {
            background-color: #ddd;
        }
        .dev-likes {
             font-weight: bold;
             color: var(--cor-destaque-usuario);
             margin-right: 15px;
        }

        /* NOVO: Estilo para Modal de Termos */
        #terms-modal .modal-content {
             max-width: 600px;
             margin: 5% auto;
        }
        #terms-modal h3 {
             color: var(--cor-destaque-usuario);
             border-bottom: 2px solid var(--cor-destaque-usuario);
             padding-bottom: 10px;
        }
        #terms-modal p {
             line-height: 1.5;
        }
        #terms-modal .term-actions button {
             width: 48%;
             margin-top: 20px;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>Cybercraft</h1>

        <div id="login-section" style="display: block;">
            <button onclick="userLogin()" style="margin-bottom: 25px;">
                <span style="font-size: 1.3em; margin-right: 10px;">üìö</span> Acessar Como Usuario Comum
            </button>
           
        
            <p style="text-align: center; margin-bottom: 20px;">
                Ou
            </p>

            <div id="login-form">
                <h3>Login do Desenvolvedor</h3>
                <input type="text" id="username" placeholder="Usu√°rio">
              
                <input type="password" id="password" placeholder="Senha">
                <button onclick="developerLogin()">Entrar como Desenvolvedor</button>
            </div>
        </div>

        <div id="dev-panel" style="display: none;">
            <h2>Painel do Desenvolvedor (<span id="dev-name"></span>)</h2>
           
            <h3>Adicionar Novo Item</h3>
    
            <label for="item-folder">Pasta:</label>
            <select id="item-folder">
                <option value="home">Home</option>
                <option value="projetos">Projetos</option>
                <option value="documentacao">Documenta√ß√£o</option>
                <option value="tutoriais">Tutoriais</option>
          
                <option value="midia">M√≠dia</option>
                <option value="diversos">Diversos</option>
                <option value="conscientizacao">Conscientiza√ß√£o</option>
            </select><br><br>
           
            <label for="file-type">Tipo:</label>
            <select id="file-type" onchange="toggleInputType()">
         
                <option value="link">Link</option>
                <option value="foto">Foto</option>
                <option value="video">V√≠deo</option>
            </select><br><br>
           
            <label for="item-name">Nome do Item:</label>
            <input type="text" id="item-name" placeholder="Ex: Relat√≥rio Final" style="width: 100%; margin-bottom: 10px;"><br>
           
            <div id="dynamic-input-container">
                <label for="item-url">URL (Link):</label>
                <input type="text" id="item-url" placeholder="http://recurso.com/link" style="width: 100%; margin-bottom: 10px;">
            </div>
           
            <label>Vis√≠vel para Usu√°rio?</label>
            <input type="checkbox" id="item-visible" checked><br><br>
           
            <button onclick="addItem()">Adicionar Item</button>

            <hr>

          
            <h3>Arquivos Gerenci√°veis por Pasta</h3>
            <div class="folder-selector" id="dev-folder-selector"></div>
           
            <div id="bulk-action-area" style="margin-bottom: 15px; text-align: right;">
                <button onclick="bulkDeleteItems()" style="background-color: var(--cor-erro); color: white;">
                    üóëÔ∏è Excluir Itens Selecionados
                </button>
            </div>
           
            <div id="dev-file-list">
            </div>
        </div>

    
        <div id="user-view" style="display: none;">
            <h2>Visualiza√ß√£o do Usu√°rio</h2>
            <div class="folder-selector" id="user-folder-selector"></div>
           
            <div id="breadcrumbs" style="margin-bottom: 10px; color: var(--cor-secundaria); font-size: 0.9em; font-style: italic;"></div>
           
            <div id="user-controls" style="display: flex; gap: 10px; align-items: center; flex-wrap: wrap;">
               
                <div id="search-container">
                    <input type="text" id="search-input" placeholder="üîç Buscar por nome do arquivo..." oninput="showSearchSuggestions()" onfocus="showSearchSuggestions()" onblur="setTimeout(() => document.getElementById('search-suggestions').style.display='none', 100)">
                    <div id="search-suggestions" style="display: none;"></div>
      
                </div>
               
                <label for="sort-select" style="white-space: nowrap;">Ordenar Por:</label>
                <select id="sort-select" onchange="renderUserView()" style="flex-shrink: 0; width: auto;">
                    <option value="name_asc">Nome (A-Z)</option>
                    <option value="name_desc">Nome (Z-A)</option>
                </select>
            </div>
           
            <div id="file-type-filters">
   
                <button onclick="setFileTypeFilter('all')" id="filter-all" class="active">Tudo</button>
                <button onclick="setFileTypeFilter('link')" id="filter-link">Links</button>
                <button onclick="setFileTypeFilter('foto')" id="filter-foto">Fotos</button>
                <button onclick="setFileTypeFilter('video')" id="filter-video">V√≠deos</button>
            </div>
           
            <div id="user-content-view">
                <div id="conscientizacao-view" style="display: none;">
                    <h3>Conscientiza√ß√£o e Regra de Ouro da Arqueologia</h3>
                    <div class="message">
                        <p style="font-weight: bold; color: var(--cor-destaque-usuario);">Aten√ß√£o! Voc√™ est√° na √°rea de Conscientiza√ß√£o. Lembre-se:</p>
                        <p>A Arqueologia √© uma ferramenta para reescrever a hist√≥ria local. Somos apenas guardi√µes e precisamos da sua ajuda para proteger o patrim√¥nio de Salto. Sua atitude √© a regra de ouro!</p>
                    </div>
                    
                    <h4>Sem√°foro da Regra de Ouro (O que fazer ao encontrar um objeto antigo)</h4>
                    <div class="semaforo-container">
                        <div class="semaforo-item semaforo-vermelho"> üõë PARE <p style="font-size: 0.9em; margin: 5px 0 0;">(N√£o mexa, n√£o limpe e n√£o remova do local)</p> </div>
                        <div class="semaforo-item semaforo-amarelo"> ‚ö†Ô∏è REGISTRE <p style="font-size: 0.9em; margin: 5px 0 0;">(Registre o objeto e o local exato)</p> </div>
                        <div class="semaforo-item semaforo-verde"> ‚úÖ LIGUE <p style="font-size: 0.9em; margin: 5px 0 0;">(Avise o IPHAN, Museu ou √≥rg√£o de patrim√¥nio)</p> </div>
                    </div>

                    <div style="text-align: center;">
                        <button onclick="changeView('educational_videos')" style="background-color: var(--cor-destaque-usuario); margin-bottom: 20px;"> Ver V√≠deos Educativos ‚ñ∂Ô∏è </button>
                    </div>
                    
                    <hr>
                    
                    <h3>Teste Seu Conhecimento: O Quiz do Guardi√£o</h3>
                    <p>Responda √†s quest√µes para testar o que voc√™ aprendeu sobre Arqueologia e a Regra de Ouro.</p>
                    <div id="quiz-container" class="quiz-container">
                    </div>
                    
                    <div id="quiz-navigation" style="text-align: center; margin-top: 15px;">
                        <button onclick="prevQuestion()" id="prev-btn" disabled>‚Üê Anterior</button>
                        <span id="question-counter" style="margin: 0 15px; font-weight: bold;"></span>
                        <button onclick="nextQuestion()" id="next-btn">Pr√≥xima ‚Üí</button>
                    </div>
                    
                    <div id="quiz-completion-area" style="text-align: center; margin-top: 20px; display: none;">
                        <button onclick="checkQuizCompletion()" style="background-color: var(--cor-principal);"> Finalizar e Ver Resultado </button>
                        <button onclick="reviewAnswers()" id="review-btn" style="background-color: var(--cor-secundaria); margin-left: 10px; display:none;"> Revisar Respostas </button>
                        <button onclick="loadQuiz()" id="restart-btn" style="background-color: var(--cor-erro); margin-left: 10px; display:none;"> Reiniciar Quiz </button>
                    </div>
                    
                </div>
                
                <div id="educational-videos-view" style="display: none;">
                    <h3>V√≠deos Educativos</h3>
                    <p>Material de v√≠deo sobre Arqueologia e Conscientiza√ß√£o.</p>
                    <div id="video-list">
                        </div>
                    <button onclick="changeView('conscientizacao_quiz')" style="margin-top: 20px;"> ‚Üê Voltar para Sem√°foro e Quiz</button>
                </div>
                
                <div id="user-file-list">
                    </div>
            </div>
            <div id="chat-panel" style="margin-top: 30px;">
                <h2 style="color: var(--cor-destaque-usuario);">Canal de Feedback e Comunica√ß√£o</h2>
                
                <div id="dev-chat-controls" style="display: none;">
                    <label for="chat-filter-select">Filtrar Mensagens:</label>
                    <select id="chat-filter-select" onchange="renderChat()">
                        <option value="all">Todas as Mensagens</option>
                        <option value="unreplied">N√£o Respondidas</option>
                    </select>
                    <div id="chat-bulk-actions">
                         <button onclick="toggleChatCheckboxes()" style="background-color: var(--cor-secundaria);"> Selecionar Tudo </button>
                         <button onclick="bulkDeleteMessages()" style="background-color: var(--cor-erro); color: white; margin-left: 10px;"> üóëÔ∏è Excluir Mensagens Selecionadas </button>
                    </div>
                </div>

                <div id="chat-messages" class="chat-messages">
                    </div>
                
                <div id="user-chat-input" style="display: none;">
                    <h3>Enviar uma mensagem / Feedback</h3>
                    <div id="chat-input-area">
                        <input type="text" id="chat-message-input" placeholder="Digite sua mensagem/feedback aqui...">
                        <button onclick="sendMessage()">Enviar</button>
                    </div>
                </div>
                
                <div id="dev-chat-reply" style="display: none;">
                    <h3>Responder √† √öltima Mensagem do Usu√°rio</h3>
                    <div id="chat-input-area">
                        <input type="text" id="chat-reply-input" placeholder="Resposta do Dev (m√°x. 1 por mensagem de usu√°rio)">
                        <button onclick="sendReply()">Responder</button>
                    </div>
                </div>
            </div>


        </div>

        <button onclick="logout()" style="margin-top: 20px; width: 100%; display: none;" id="main-logout-button">Sair</button>

    </div>

    <div id="edit-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="document.getElementById('edit-modal').style.display='none'">&times;</span>
            <h3>‚úèÔ∏è Editar Item</h3>
            <input type="hidden" id="edit-file-index">
            
            <label for="edit-name">Nome do Item:</label>
            <input type="text" id="edit-name" placeholder="Nome do Item">
            
            <label for="edit-folder">Pasta:</label>
            <select id="edit-folder">
                <option value="home">Home</option>
                <option value="projetos">Projetos</option>
                <option value="documentacao">Documenta√ß√£o</option>
                <option value="tutoriais">Tutoriais</option>
                <option value="midia">M√≠dia</option>
                <option value="diversos">Diversos</option>
                <option value="conscientizacao">Conscientiza√ß√£o</option>
            </select><br><br>
            
            <label for="edit-url">URL:</label>
            <input type="text" id="edit-url" placeholder="URL ou Caminho do Arquivo">
            
            <label>Vis√≠vel para Usu√°rio?</label>
            <input type="checkbox" id="edit-visible"><br><br>
            
            <button onclick="saveEdit()">Salvar Altera√ß√µes</button>
        </div>
    </div>
    
    <div id="media-viewer-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="document.getElementById('media-viewer-modal').style.display='none'">&times;</span>
            <div id="media-content">
                </div>
        </div>
    </div>
    
    <div id="terms-modal" class="modal">
        <div class="modal-content">
            <h3>Termos de Uso e Conscientiza√ß√£o</h3>
            <p>Ao acessar o conte√∫do do Cybercraft, voc√™ concorda com os seguintes termos:</p>
            <ol>
                <li><strong>Finalidade Educacional:</strong> O material aqui contido √© apenas para fins de estudo e conscientiza√ß√£o sobre Arqueologia e Patrim√¥nio Hist√≥rico.</li>
                <li><strong>Regra de Ouro:</strong> Voc√™ se compromete a seguir a "Regra de Ouro da Arqueologia" (PARE, REGISTRE e LIGUE) em caso de descoberta de qualquer vest√≠gio arqueol√≥gico.</li>
                <li><strong>Respeito ao Patrim√¥nio:</strong> √â proibido manipular, remover ou danificar quaisquer s√≠tios ou artefatos. A preserva√ß√£o √© responsabilidade de todos.</li>
                <li><strong>Feedback Construtivo:</strong> O canal de feedback deve ser usado para sugest√µes construtivas ou para reportar descobertas e problemas.</li>
            </ol>
            <p style="font-weight: bold; margin-top: 15px;">Este √© um compromisso com a aceita√ß√£o da sua responsabilidade como promotor da hist√≥ria local e na concord√¢ncia em manter um comportamento que honre o legado arqueol√≥gico de Salto.</p>
            <div class="term-actions" style="display: flex; justify-content: space-between;">
                <button onclick="declineTerms()" style="background-color: var(--cor-erro);"> N√£o Aceitar e Sair </button>
                <button onclick="acceptTerms()" style="background-color: var(--cor-destaque-usuario);"> Aceitar Termos e Continuar </button>
            </div>
        </div>
    </div>

    <script>
        // --- Configura√ß√µes ---
        // Objeto com os usu√°rios e senhas de acesso de Desenvolvedor
        const DEVELOPERS = {
            "davi": "060973",
            "girotto": "jUlia2012",
            "luiza": "lulu@2013",
            "gustavo": "YqbJSqtm",
            "enzo": "212620638VMect@",
            "vieira": "Narnia01",
            "luiz": "02092013",
            "marilia": "estela2015",
            "sofia": "3547",
            "anna": "Ana2025"
        };
        const FOLDERS = {
            "home": "Home",
            "projetos": "Projetos",
            "documentacao": "Documenta√ß√£o",
            "tutoriais": "Tutoriais",
            "midia": "M√≠dia",
            "diversos": "Diversos",
            "conscientizacao": "Conscientiza√ß√£o"
        };
        // RESPOSTAS CORRETAS REEQUILIBRADAS: B, C, A, B, C
        const QUIZ_QUESTIONS = [
            {
                question: "1. Qual √© o trabalho principal do arque√≥logo?",
                options: [
                    "A) Construir casas.",
                    "B) Estudar coisas antigas que os humanos deixaram (como panelas e ferramentas).",
                    "C) Cuidar de animais na floresta."
                ],
                answerIndex: 1, // B
                explanation: "Os arque√≥logos estudam a hist√≥ria humana atrav√©s de vest√≠gios materiais (artefatos, estruturas) para entender como as pessoas viviam no passado."
            },
            {
                question: "2. O que significa a regra VERMELHA (PARE) ao encontrar um vest√≠gio arqueol√≥gico?",
                options: [
                    "A) Pegar o objeto rapidamente para lev√°-lo para casa.",
                    "B) Tentar limpar o objeto e desenterr√°-lo com cuidado.",
                    "C) N√£o mexer no objeto, n√£o limpar e n√£o remover do local para preservar o contexto."
                ],
                answerIndex: 2, // C
                explanation: "Parar √© o primeiro passo. O contexto √© a informa√ß√£o mais valiosa; remover o objeto antes do registro destr√≥i essa informa√ß√£o."
            },
            {
                question: "3. Por que √© importante registrar (REGISTRE) o local exato da descoberta?",
                options: [
                    "A) Para que os arque√≥logos possam ir ao local e entender o s√≠tio, coletando mais informa√ß√µes.",
                    "B) Para esconder o local e voltar mais tarde.",
                    "C) Para apenas tirar fotos e postar nas redes sociais."
                ],
                answerIndex: 0, // A
                explanation: "O registro permite que especialistas identifiquem, mapeiem e analisem o s√≠tio corretamente, protegendo o patrim√¥nio hist√≥rico."
            },
            {
                question: "4. Qual tipo de patrim√¥nio o Sem√°foro da Arqueologia de Salto visa proteger?",
                options: [
                    "A) Florestas e animais selvagens.",
                    "B) O patrim√¥nio hist√≥rico e arqueol√≥gico deixado pelos antigos habitantes de Salto.",
                    "C) Apenas pr√©dios antigos e igrejas."
                ],
                answerIndex: 1, // B
                explanation: "O objetivo √© proteger os vest√≠gios da ocupa√ß√£o humana pr√©-hist√≥rica e hist√≥rica em Salto."
            },
            {
                question: "5. Se voc√™ encontrar um objeto antigo na rua, o que a regra VERDE (LIGUE) significa?",
                options: [
                    "A) Ligar para um amigo para mostrar.",
                    "B) Ligar para a fam√≠lia para contar a novidade.",
                    "C) Ligar para a pol√≠cia ou √≥rg√£o de patrim√¥nio (como o IPHAN ou museu local) para relatar a descoberta."
                ],
                answerIndex: 2, // C
                explanation: "A regra Verde exige que se contate imediatamente as autoridades competentes para que o objeto possa ser investigado e preservado corretamente."
            }
        ];
        let files = JSON.parse(localStorage.getItem('files')) || [];
        let messages = JSON.parse(localStorage.getItem('chatMessages')) || [];
        let currentUser = null;
        let currentFolder = 'home';
        let fileDataUrl = null;
        // NOVO: Sugest√£o 2 - Filtro de Arquivo Ativo
        let currentFileTypeFilter = 'all'; 

        // Vari√°veis do Quiz
        let userAnswers = Array(QUIZ_QUESTIONS.length).fill(null);
        let score = 0;
        let currentQuestionIndex = 0;

        // --- Fun√ß√µes Auxiliares ---
        function saveFiles() {
            localStorage.setItem('files', JSON.stringify(files));
        }
        function saveMessages() {
            localStorage.setItem('chatMessages', JSON.stringify(messages));
        }

        // Fun√ß√£o para obter o √≠cone baseado no tipo de arquivo
        function getFileIcon(type) {
            switch (type) {
                case 'link': return 'üîó';
                case 'foto': return 'üñºÔ∏è';
                case 'video': return 'üé¨';
                default: return 'üìÑ';
            }
        }

        function toggleInputType() {
            const type = document.getElementById('file-type').value;
            const container = document.getElementById('dynamic-input-container');
            
            if (type === 'link') {
                container.innerHTML = `
                    <label for="item-url">URL (Link):</label>
                    <input type="text" id="item-url" placeholder="http://recurso.com/link" style="width: 100%; margin-bottom: 10px;">
                `;
            } else {
                let acceptType = type === 'foto' ? 'image/*' : 'video/*';
                container.innerHTML = `
                    <label for="item-file">Selecione o Arquivo (${type.toUpperCase()}):</label>
                    <input type="file" id="item-file" accept="${acceptType}" onchange="previewFile(event)">
                    <p id="file-preview-name" style="font-size: 0.8em; margin-top: 5px; color: var(--cor-secundaria);"></p>
                    <input type="hidden" id="item-url"> `;
            }
        }
        
        // Fun√ß√£o para visualiza√ß√£o de arquivo local antes do upload
        function previewFile(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    fileDataUrl = e.target.result; // Armazena o Data URL
                    document.getElementById('file-preview-name').textContent = `Arquivo selecionado: ${file.name}`;
                };
                reader.readAsDataURL(file); // L√™ o arquivo como Data URL
            } else {
                fileDataUrl = null;
                document.getElementById('file-preview-name').textContent = '';
            }
        }
        
        // Fun√ß√£o para mudar a view principal do usu√°rio
        function changeView(view) {
             const userFileList = document.getElementById('user-file-list');
             const conscientizacaoView = document.getElementById('conscientizacao-view');
             const videosScreen = document.getElementById('educational-videos-view');
             const userControls = document.getElementById('user-controls');
             const fileFilters = document.getElementById('file-type-filters');
             
             // Esconde todas as views primeiro
             userFileList.style.display = 'none';
             conscientizacaoView.style.display = 'none';
             videosScreen.style.display = 'none';
             userControls.style.display = 'none';
             fileFilters.style.display = 'none';
             
             // Mostra a view solicitada e ajusta os controles
             if (view === 'conscientizacao_quiz') {
                 conscientizacaoView.style.display = 'block';
                 videosScreen.style.display = 'none'; // Garante que a tela de v√≠deos est√° escondida
                 loadQuiz(); // Carrega o quiz
             } else if (view === 'educational_videos') {
                 videosScreen.style.display = 'block';
                 conscientizacaoView.style.display = 'none'; // Garante que o quiz est√° escondido
                 // Controles e filtros permanecem escondidos, pois esta √© uma tela especial.
                 loadEducationalVideos();
             } else {
                 userFileList.style.display = 'block';
                 videosScreen.style.display = 'none';
                 userControls.style.display = 'flex'; // Mostra controles em pastas normais
                 fileFilters.style.display = 'flex'; // Mostra filtros
             }
        }
        
        function changeFolder(folderKey) {
            currentFolder = folderKey;
            updateFolderSelector('dev');
            updateFolderSelector('user');
            
            // Atualiza Breadcrumbs
            const breadcrumbs = document.getElementById('breadcrumbs');
            breadcrumbs.textContent = `Voc√™ est√° em: ${FOLDERS[currentFolder]}`;

            if (document.getElementById('dev-panel').style.display === 'block') {
                renderDevPanel();
            } else if (document.getElementById('user-view').style.display === 'block') {
                // L√≥gica de visualiza√ß√£o do usu√°rio
                if (currentFolder === 'conscientizacao') {
                    changeView('conscientizacao_quiz');
                } else {
                    changeView('default'); // Oculta views especiais e mostra a lista normal com controles
                    renderUserView(); // Renderiza o conte√∫do da pasta padr√£o
                }
            }
        }

        function updateFolderSelector(view) {
            const selectorDiv = document.getElementById(`${view}-folder-selector`);
            selectorDiv.innerHTML = '';
            for (const key in FOLDERS) {
                const button = document.createElement('button');
                button.textContent = FOLDERS[key];
                button.setAttribute('onclick', `changeFolder('${key}')`);
                if (key === currentFolder) {
                    button.classList.add('active');
                }
                selectorDiv.appendChild(button);
            }
        }
        
        // NOVO: Sugest√£o 2 - Fun√ß√µes de Filtro de Arquivo
        function setFileTypeFilter(type) {
            currentFileTypeFilter = type;
            // Atualiza o estado visual dos bot√µes
            document.querySelectorAll('#file-type-filters button').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`filter-${type}`).classList.add('active');
            renderUserView();
        }

        // --- Renderiza√ß√£o do Painel do Desenvolvedor ---
        function renderDevPanel() {
            const devList = document.getElementById('dev-file-list');
            devList.innerHTML = '';
            const filteredFiles = files.filter(file => file.folder === currentFolder);

            if (filteredFiles.length === 0) {
                devList.innerHTML = `<p style="text-align: center; margin-top: 20px;">Nenhum item nesta pasta.</p>`;
                return;
            }

            // Exibir a lista de arquivos
            filteredFiles.forEach((file, index) => {
                const originalIndex = files.indexOf(file); // Encontrar o √≠ndice original no array 'files'
                const item = document.createElement('div');
                item.className = 'dev-item';
                
                // Checkbox para exclus√£o em massa
                const checkbox = document.createElement('input');
                checkbox.type = 'checkbox';
                checkbox.className = 'bulk-delete-checkbox';
                checkbox.setAttribute('data-file-index', originalIndex);

                // Conte√∫do do item
                const icon = getFileIcon(file.type);
                const visibility = file.visible ? 'üü¢ Vis√≠vel' : 'üî¥ Oculto';
                const contentSpan = document.createElement('span');
                const lastEditorInfo = file.lastEditor ? `(Editado por: ${file.lastEditor.toUpperCase()})` : '';

                contentSpan.innerHTML = `
                    <span style="font-weight: bold;">${icon} ${file.name}</span>
                    <span class="dev-info">
                        [Pasta: ${FOLDERS[file.folder]} | Tipo: ${file.type.charAt(0).toUpperCase() + file.type.slice(1)} | Criador: ${file.developer.toUpperCase()}]
                        <br>
                        ${visibility} ${lastEditorInfo}
                    </span>
                `;

                // Div para os bot√µes de a√ß√£o individual
                const actionDiv = document.createElement('div');
                actionDiv.innerHTML = `
                    <button onclick="openEditModal(${originalIndex})" style="background-color: var(--cor-principal);">Editar</button>
                    <button onclick="toggleVisibility(${originalIndex})">${file.visible ? 'Ocultar' : 'Tornar Vis√≠vel'}</button>
                    <button onclick="deleteItem(${originalIndex})" style="background-color: var(--cor-erro);">Excluir</button>
                `;

                item.appendChild(checkbox);
                item.appendChild(contentSpan);
                item.appendChild(actionDiv);
                devList.appendChild(item);
            });
        }

        // Fun√ß√£o para exclus√£o em massa de arquivos
        function bulkDeleteItems() {
            const selectedCheckboxes = document.querySelectorAll('#dev-file-list .bulk-delete-checkbox:checked');
            
            if (selectedCheckboxes.length === 0) {
                alert('Nenhum item selecionado para exclus√£o em massa.');
                return;
            }

            if (!confirm(`Tem certeza que deseja excluir ${selectedCheckboxes.length} item(ns) permanentemente? Esta a√ß√£o √© irrevers√≠vel!`)) {
                return;
            }

            // 1. Coletar os √≠ndices dos arquivos a serem exclu√≠dos (os √≠ndices no array 'files')
            const indicesToDelete = [];
            selectedCheckboxes.forEach(checkbox => {
                // O atributo data-file-index armazena o √≠ndice original no array 'files'
                indicesToDelete.push(parseInt(checkbox.getAttribute('data-file-index')));
            });

            // 2. Ordenar os √≠ndices em ordem decrescente.
            // Isso √© CRUCIAL ao usar splice em um loop, para que a exclus√£o de um item n√£o mude o √≠ndice do pr√≥ximo item a ser exclu√≠do.
            indicesToDelete.sort((a, b) => b - a);

            // 3. Excluir os itens do array 'files'
            indicesToDelete.forEach(index => {
                if (index >= 0 && index < files.length) {
                    files.splice(index, 1);
                }
            });

            saveFiles();
            alert(`Exclus√£o em massa conclu√≠da. ${selectedCheckboxes.length} item(ns) exclu√≠do(s).`);
            renderDevPanel();
        }
        
        // --- Fun√ß√µes de A√ß√£o de Item (Dev) ---
        function toggleVisibility(index) {
            files[index].visible = !files[index].visible;
            files[index].lastEditor = currentUser; // Registra o editor
            saveFiles();
            renderDevPanel();
        }

        function deleteItem(index) {
            if (confirm(`Tem certeza que deseja excluir o item '${files[index].name}'?`)) {
                files.splice(index, 1);
                saveFiles();
                renderDevPanel();
            }
        }

        function openEditModal(index) {
            const file = files[index];
            document.getElementById('edit-file-index').value = index;
            document.getElementById('edit-name').value = file.name;
            document.getElementById('edit-folder').value = file.folder;
            document.getElementById('edit-url').value = file.url;
            document.getElementById('edit-visible').checked = file.visible;
            document.getElementById('edit-modal').style.display = 'block';
        }

        function saveEdit() {
            const index = document.getElementById('edit-file-index').value;
            const name = document.getElementById('edit-name').value.trim();
            const folder = document.getElementById('edit-folder').value;
            const url = document.getElementById('edit-url').value.trim();
            const visible = document.getElementById('edit-visible').checked;

            if (!name || (!url && (files[index].type === 'link' || files[index].type === 'video'))) {
                alert('Nome e URL/Arquivo s√£o obrigat√≥rios.');
                return;
            }

            files[index].name = name;
            files[index].folder = folder;
            files[index].url = url || files[index].url; // Mant√©m a URL anterior se a nova estiver vazia (para o caso de foto/video local que n√£o pode ser re-selecionado)
            files[index].visible = visible;
            // NOVO: Adiciona o campo lastEditor
            files[index].lastEditor = currentUser; 
            
            saveFiles();
            document.getElementById('edit-modal').style.display = 'none';
            alert('Item editado com sucesso!');
            changeFolder(currentFolder); // Re-renderiza a pasta atual
        }
        
        // NOVO: Fun√ß√£o para curtir item
        function likeItem(index) {
            if (files[index]) {
                // Inicializa likes se n√£o existir
                if (typeof files[index].likes !== 'number') {
                    files[index].likes = 0;
                }
                files[index].likes += 1;
                saveFiles();
                renderUserView(); // Re-renderiza para atualizar o contador
            }
        }

        // NOVO: Sugest√£o 8 - Fun√ß√£o para Compartilhar Item
        function copyItemUrl(url) {
            navigator.clipboard.writeText(url)
                .then(() => {
                    alert('üîó Link do recurso copiado para a √°rea de transfer√™ncia!');
                })
                .catch(err => {
                    console.error('Erro ao copiar link:', err);
                    alert('Erro ao copiar o link. Tente copiar manualmente: ' + url);
                });
        }
        
        // NOVO: Sugest√£o 3 - Abrir Modal de Visualiza√ß√£o R√°pida de M√≠dia
        function openMediaViewer(url, type, name) {
            const modal = document.getElementById('media-viewer-modal');
            const content = document.getElementById('media-content');
            content.innerHTML = ''; // Limpa o conte√∫do anterior
            
            if (type === 'foto') {
                 content.innerHTML = `<img src="${url}" alt="${name || 'Foto'}">`;
            } else if (type === 'video') {
                 content.innerHTML = `<video controls src="${url}"></video>`;
            }
            
            modal.style.display = 'block';
        }
        
        // NOVO: Sugest√£o 6 - Mostrar Sugest√µes de Busca
        function showSearchSuggestions() {
            const input = document.getElementById('search-input');
            const suggestionsDiv = document.getElementById('search-suggestions');
            const searchTerm = input.value.toLowerCase().trim();

            // 1. Encontrar todos os arquivos vis√≠veis na pasta atual
            const visibleFiles = files.filter(file => file.visible && file.folder === currentFolder);

            if (searchTerm.length > 0) {
                // 2. Filtrar arquivos que contenham o termo de busca no nome
                const matches = visibleFiles
                    .filter(file => file.name.toLowerCase().includes(searchTerm))
                    .slice(0, 5); // Limita a 5 sugest√µes
                
                suggestionsDiv.innerHTML = '';
                if (matches.length > 0) {
                    matches.forEach(file => {
                        const suggestionItem = document.createElement('div');
                        suggestionItem.className = 'suggestion-item';
                        suggestionItem.textContent = `${getFileIcon(file.type)} ${file.name}`;
                        suggestionItem.onclick = function() {
                            input.value = file.name; // Preenche o input
                            suggestionsDiv.style.display = 'none'; // Esconde sugest√µes
                            renderUserView(); // Executa a busca
                        };
                        suggestionsDiv.appendChild(suggestionItem);
                    });
                    suggestionsDiv.style.display = 'block';
                } else {
                    suggestionsDiv.style.display = 'none';
                }
            } else {
                suggestionsDiv.style.display = 'none';
            }
        }

        // --- Renderiza√ß√£o da Visualiza√ß√£o do Usu√°rio ---
        function renderUserView() {
            // Apenas renderiza a lista de arquivos padr√£o, views especiais s√£o tratadas em changeView
            const userList = document.getElementById('user-file-list');
            userList.innerHTML = '';
            
            // 1. Filtrar por Pasta
            let visibleFiles = files.filter(file => file.visible && file.folder === currentFolder);
            
            // 2. Aplicar Busca (Sugest√£o 6)
            const searchTerm = document.getElementById('search-input').value.toLowerCase().trim();
            if (searchTerm) {
                visibleFiles = visibleFiles.filter(file => file.name.toLowerCase().includes(searchTerm));
            }
            
            // 3. Aplicar Filtro por Tipo (Sugest√£o 2)
            if (currentFileTypeFilter !== 'all') {
                visibleFiles = visibleFiles.filter(file => file.type === currentFileTypeFilter);
            }
            
            // 4. Aplica Ordena√ß√£o
            const sortMethod = document.getElementById('sort-select').value;
            visibleFiles.sort((a, b) => {
                const nameA = a.name.toUpperCase();
                const nameB = b.name.toUpperCase();
                if (sortMethod === 'name_asc') {
                    return (nameA < nameB) ? -1 : (nameA > nameB) ? 1 : 0;
                } else if (sortMethod === 'name_desc') {
                    return (nameA > nameB) ? -1 : (nameA < nameB) ? 1 : 0;
                }
                return 0; // Padr√£o
            });
            
            // --- CONTE√öDO ESPECIAL PARA A PASTA 'CONSCIENTIZA√á√ÉO' ---
            if (currentFolder === 'conscientizacao') {
                document.getElementById('user-controls').style.display = 'none';
                document.getElementById('file-type-filters').style.display = 'none';
                loadQuiz(); // Inicia o carregamento do conte√∫do de conscientiza√ß√£o
                return;
            }
            // --- FIM CONTE√öDO ESPECIAL ---

            // Conte√∫do especial para a pasta 'home'
            if (currentFolder === 'home') {
                const homeListContainer = document.getElementById('user-file-list');
                
                // Painel de boas-vindas/Informa√ß√£o
                homeListContainer.innerHTML = `
                    <div class="info-panel">
                        <h2>Bem-vindo ao Cybercraft!</h2>
                        <h3>Seu Portal para a Hist√≥ria e Arqueologia de Salto.</h3>
                        <p>Use o menu acima para navegar pelas pastas de recursos (Projetos, Documenta√ß√£o, etc.).</p>
                    </div>
                `;
                
                // Filtra apenas a home e aplica a busca/ordena√ß√£o
                const homeFiles = visibleFiles;

                if (homeFiles.length > 0) {
                    homeListContainer.innerHTML += `<h3 style="margin-top: 30px; border-bottom: 1px dotted var(--cor-borda); padding-bottom: 10px;">Quadro de Avisos</h3>`;
                    
                    let dashboardGridHTML = `<div class="dashboard-grid">`;
                    homeFiles.forEach(file => {
                        const originalIndex = files.indexOf(file);
                        const icon = getFileIcon(file.type);
                        const likes = file.likes || 0;
                        const fileLink = file.url;
                        const editorInfo = file.lastEditor ? `√öltima Edi√ß√£o: ${file.lastEditor.toUpperCase()}` : '';
                        
                        let cardContent;
                        let cardAction;

                        if (file.type === 'foto' && fileLink.startsWith('data:image')) {
                            // Pr√©-visualiza√ß√£o para fotos
                            cardContent = `<img src="${fileLink}" alt="Pr√©-visualiza√ß√£o" class="card-image-preview">`;
                            cardAction = `onclick="openMediaViewer('${fileLink}', 'foto', '${file.name}')" href="javascript:void(0)"`;
                        } else if (file.type === 'video') {
                            // √çcone grande para v√≠deos
                            cardContent = `<span class="card-icon">${icon}</span>`;
                            cardAction = `onclick="openMediaViewer('${fileLink}', 'video', '${file.name}')" href="javascript:void(0)"`;
                        } else {
                            // √çcone grande para links e outros
                            cardContent = `<span class="card-icon">${icon}</span>`;
                            cardAction = `href="${fileLink}" target="_blank"`;
                        }

                        dashboardGridHTML += `
                            <a class="dashboard-card" ${cardAction}>
                                <div>
                                    ${cardContent}
                                    <div class="card-name">${file.name}</div>
                                    <div class="card-type">Tipo: ${file.type.charAt(0).toUpperCase() + file.type.slice(1)}</div>
                                </div>
                                <div class="card-dev-info">${editorInfo}</div>
                            </a>
                        `;
                    });
                    dashboardGridHTML += `</div>`;
                    homeListContainer.innerHTML += dashboardGridHTML;
                }
                return;
            }

            // --- IN√çCIO DA RENDERIZA√á√ÉO PADR√ÉO PARA OUTRAS PASTAS ---
            if (visibleFiles.length === 0) {
                userList.innerHTML += `<p>Nenhum arquivo ou link vis√≠vel na pasta "${FOLDERS[currentFolder]}" que corresponda aos seus filtros de busca/tipo.</p>`;
                return;
            }

            // Renderiza arquivos (visualiza√ß√£o de lista para outras pastas)
            visibleFiles.forEach(file => {
                const originalIndex = files.indexOf(file); // Pega o √≠ndice original
                const item = document.createElement('div');
                item.className = 'file-item';
                const icon = getFileIcon(file.type); // Obt√©m o √≠cone
                const editorInfo = file.lastEditor ? `(Editado por: ${file.lastEditor.toUpperCase()})` : '';
                const likes = file.likes || 0;
                const fileLink = file.url; // URL do arquivo

                let contentHTML = `
                    <h4 style="color: var(--cor-principal); margin-bottom: 5px;"> ${icon} ${file.name} </h4>
                    <p style="margin-bottom: 10px; font-size: 0.9em; color: var(--cor-secundaria);">
                        Tipo: ${file.type.charAt(0).toUpperCase() + file.type.slice(1)} | Criado por: ${file.developer.toUpperCase()} ${editorInfo}
                    </p>
                    <hr style="border-top: 1px dotted var(--cor-borda); margin-bottom: 15px;">
                `;

                // Sugest√£o 3: Link de Acesso com Modal/A√ß√£o
                if (file.type === 'link') {
                    contentHTML += `<a href="${file.url}" target="_blank">Acessar Link</a>`;
                } else if (file.type === 'foto') {
                    if (file.url.startsWith('data:image')) { // NOVO: Chama o Modal
                         contentHTML += `<a href="javascript:void(0)" onclick="openMediaViewer('${fileLink}', 'foto', '${file.name}')">Visualizar Foto (R√°pido)</a>`;
                    } else {
                         contentHTML += `<a href="${file.url}" target="_blank">Visualizar Foto (Link Externo)</a>`;
                    }
                } else if (file.type === 'video') {
                     contentHTML += `<a href="javascript:void(0)" onclick="openMediaViewer('${fileLink}', 'video', '${file.name}')">Assistir V√≠deo (R√°pido)</a>`;
                }

                // Sugest√£o 8: A√ß√µes de Curtir e Compartilhar
                contentHTML += `
                    <div class="item-actions">
                        <span class="dev-likes">‚ù§Ô∏è ${likes}</span>
                        <button class="like-button" onclick="likeItem(${originalIndex})">Curtir</button>
                        <button class="share-button" onclick="copyItemUrl('${fileLink}')">Compartilhar üîó</button>
                    </div>
                `;

                item.innerHTML = contentHTML;
                userList.appendChild(item);
            });
        }
        
        // --- Fun√ß√µes do Quiz ---
        function loadQuiz() {
            const container = document.getElementById('conscientizacao-view');
            // Garante que o container do quiz/semaforo est√° vis√≠vel e a lista de arquivos est√° escondida
            document.getElementById('user-file-list').style.display = 'none';
            container.style.display = 'block';

            // Reseta o estado do quiz
            userAnswers.fill(null);
            score = 0;
            currentQuestionIndex = 0;
            
            // Reseta a √°rea de navega√ß√£o e conclus√£o
            document.getElementById('quiz-navigation').style.display = 'block';
            document.getElementById('quiz-completion-area').style.display = 'none';
            document.getElementById('review-btn').style.display = 'none';
            document.getElementById('restart-btn').style.display = 'none';
            document.getElementById('quiz-completion-area').querySelector('button:first-child').style.display = 'inline-block'; // Mostra Finalizar
            
            displayQuestion();
        }

        function displayQuestion() {
            const container = document.getElementById('quiz-container');
            const currentQ = QUIZ_QUESTIONS[currentQuestionIndex];
            
            // Renderiza a pergunta
            let optionsHTML = currentQ.options.map((option, index) => {
                const isSelected = userAnswers[currentQuestionIndex] === index ? 'selected' : '';
                return `<div class="quiz-option ${isSelected}" onclick="selectAnswer(${index})">${option}</div>`;
            }).join('');

            container.innerHTML = `
                <div class="quiz-question">
                    ${currentQ.question}
                </div>
                <div>
                    ${optionsHTML}
                </div>
            `;
            
            // Atualiza navega√ß√£o
            document.getElementById('question-counter').textContent = `Pergunta ${currentQuestionIndex + 1} de ${QUIZ_QUESTIONS.length}`;
            document.getElementById('prev-btn').disabled = currentQuestionIndex === 0;
            
            // Oculta/Mostra bot√£o de Pr√≥xima/Finalizar
            const nextBtn = document.getElementById('next-btn');
            const finishBtn = document.getElementById('quiz-completion-area').querySelector('button:first-child');
            
            if (currentQuestionIndex === QUIZ_QUESTIONS.length - 1) {
                nextBtn.style.display = 'none';
                finishBtn.style.display = 'inline-block';
            } else {
                nextBtn.style.display = 'inline-block';
                finishBtn.style.display = 'none';
            }
        }
        
        function selectAnswer(index) {
            // Se o quiz j√° foi finalizado e est√° em modo de revis√£o, n√£o permitir mudan√ßa
            if (document.getElementById('review-btn').style.display === 'inline-block') return; 
            
            userAnswers[currentQuestionIndex] = index;
            displayQuestion(); // Re-renderiza para aplicar a classe 'selected'
        }

        function nextQuestion() {
            if (currentQuestionIndex < QUIZ_QUESTIONS.length - 1) {
                currentQuestionIndex++;
                displayQuestion();
            }
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }
        
        function checkQuizCompletion() {
            // Verifica se todas as perguntas foram respondidas
            const notAnswered = userAnswers.indexOf(null);
            if (notAnswered !== -1) {
                alert(`Por favor, responda a todas as perguntas. A pergunta ${notAnswered + 1} ainda n√£o foi respondida.`);
                currentQuestionIndex = notAnswered;
                displayQuestion();
                return;
            }
            calculateScore();
        }

        function calculateScore() {
            let newScore = 0;
            QUIZ_QUESTIONS.forEach((q, index) => {
                if (userAnswers[index] === q.answerIndex) {
                    newScore++;
                }
            });
            score = newScore;
            showFinalResult();
        }

        function showFinalResult() {
            const container = document.getElementById('quiz-container');
            const completionArea = document.getElementById('quiz-completion-area');
            const nav = document.getElementById('quiz-navigation');

            container.innerHTML = `
                <div class="quiz-result">
                    <h3>üèÜ Resultado Final üèÜ</h3>
                    <p>Sua pontua√ß√£o: ${score} de ${QUIZ_QUESTIONS.length}</p>
                    ${score === QUIZ_QUESTIONS.length ? 
                        '<p style="color: var(--cor-destaque-usuario); font-size: 1.2em;">Parab√©ns! Voc√™ √© um verdadeiro Guardi√£o da Hist√≥ria!</p>' : 
                        '<p style="color: var(--cor-erro); font-size: 1.2em;">Voc√™ pode melhorar! Revise o material e tente novamente.</p>'
                    }
                </div>
            `;
            
            // Esconde navega√ß√£o, mostra bot√µes de a√ß√£o final
            nav.style.display = 'none';
            completionArea.style.display = 'block';
            completionArea.querySelector('button:first-child').style.display = 'none'; // Esconde 'Finalizar'
            document.getElementById('review-btn').style.display = 'inline-block';
            document.getElementById('restart-btn').style.display = 'inline-block';
        }

        function reviewAnswers() {
            const container = document.getElementById('quiz-container');
            container.innerHTML = `<h3>Revis√£o do Quiz</h3>`;
            
            QUIZ_QUESTIONS.forEach((q, index) => {
                const isCorrect = userAnswers[index] === q.answerIndex;
                const reviewHTML = document.createElement('div');
                reviewHTML.className = 'quiz-question';
                reviewHTML.style.borderTop = '1px solid var(--cor-secundaria)';
                reviewHTML.innerHTML = `
                    <p style="color: ${isCorrect ? 'var(--cor-destaque-usuario)' : 'var(--cor-erro)'};">
                        ${isCorrect ? '‚úÖ Resposta Correta' : '‚ùå Resposta Incorreta'}
                    </p>
                    <p style="margin-bottom: 10px; font-size: 1.1em;">
                        ${index + 1}. ${q.question.substring(q.question.indexOf('.') + 1).trim()}
                    </p>
                    <p><strong>Sua Resposta:</strong> ${q.options[userAnswers[index]] || 'N√£o respondida'}</p>
                    <p style="color: var(--cor-destaque-usuario);"><strong>Resposta Correta:</strong> ${q.options[q.answerIndex]}</p>
                    <p style="font-size: 0.9em; margin-top: 10px; color: var(--cor-secundaria);">
                        *Explica√ß√£o: ${q.explanation}
                    </p>
                `;
                container.appendChild(reviewHTML);
            });
        }
        
        // Fun√ß√µes para carregar V√≠deos Educativos (Exemplo)
        function loadEducationalVideos() {
            const videoList = document.getElementById('video-list');
            const videos = files.filter(f => f.folder === 'conscientizacao' && f.type === 'video' && f.visible);
            
            if (videos.length === 0) {
                 videoList.innerHTML = `<p>Nenhum v√≠deo educativo dispon√≠vel no momento.</p>`;
                 return;
            }
            
            videoList.innerHTML = videos.map(file => {
                 return `
                    <div class="video-item">
                       <a href="javascript:void(0)" onclick="openMediaViewer('${file.url}', 'video', '${file.name}')">üé¨ ${file.name} - Clique para Assistir</a>
                    </div>
                 `;
            }).join('');
        }


        // --- Fun√ß√µes do Chat/Feedback ---
        function sendMessage() {
            const input = document.getElementById('chat-message-input');
            const content = input.value.trim();
            if (!content) {
                alert('A mensagem n√£o pode estar vazia.');
                return;
            }
            messages.push({
                sender: 'user',
                content: content,
                timestamp: new Date().toISOString(),
                reply: false // Marca como n√£o respondida
            });
            saveMessages();
            input.value = '';
            renderChat();
            alert('Mensagem/Feedback enviado com sucesso!');
        }
        
        function sendReply() {
            const replyInput = document.getElementById('chat-reply-input');
            const replyContent = replyInput.value.trim();
            if (!replyContent) {
                alert('A resposta n√£o pode estar vazia.');
                return;
            }

            // 1. Encontra a √∫ltima mensagem de usu√°rio sem resposta
            const userMessageIndex = messages.findLastIndex(msg => msg.sender === 'user' && !msg.reply);
            
            if (userMessageIndex === -1) {
                alert('Nenhuma mensagem de usu√°rio pendente de resposta.');
                return;
            }

            // 2. Adiciona a resposta do desenvolvedor (nova mensagem)
            messages.push({
                sender: 'dev',
                content: replyContent,
                timestamp: new Date().toISOString(),
                developer: currentUser
            });

            // 3. Marca a mensagem original do usu√°rio como respondida
            messages[userMessageIndex].reply = true;
            saveMessages();
            replyInput.value = '';
            renderChat();
            alert('Resposta enviada com sucesso.');
        }

        function renderChat() {
            const chatDiv = document.getElementById('chat-messages');
            chatDiv.innerHTML = '';
            const isDev = !!DEVELOPERS[currentUser];
            
            // Filtra as mensagens se for Dev
            const filterValue = isDev ? document.getElementById('chat-filter-select').value : 'all';
            const filteredMessages = messages.filter(msg => {
                if (filterValue === 'unreplied') {
                    // Mensagens sem reply do dev (apenas do usu√°rio)
                    return msg.sender === 'user' && !msg.reply;
                }
                return true; // Todos os outros casos (all ou user comum)
            });

            filteredMessages.forEach((msg, index) => {
                const item = document.createElement('div');
                item.className = 'message-item ' + (msg.sender === 'dev' ? 'dev-reply' : 'user-message');
                
                const contentDiv = document.createElement('div');
                contentDiv.style.flexGrow = '1';
                
                const replyMeta = msg.reply ? `<span style="color: var(--cor-destaque-usuario); font-weight: bold;">(RESPONDIDA)</span>` : (msg.sender === 'user' ? `<span style="color: var(--cor-erro);"> (AGUARDANDO)</span>` : '');
                
                contentDiv.innerHTML = `
                    <p style="margin: 0;"> ${msg.content} </p>
                    <span class="message-meta">
                        ${msg.sender.toUpperCase()} | ${new Date(msg.timestamp).toLocaleString()} ${replyMeta}
                    </span>
                `;

                if (isDev) {
                    // Checkbox para Exclus√£o em Massa (Apenas Dev)
                    const checkbox = document.createElement('input');
                    checkbox.type = 'checkbox';
                    checkbox.className = 'bulk-delete-chat-checkbox';
                    checkbox.setAttribute('data-message-index', index);
                    item.prepend(checkbox);
                }
                
                item.appendChild(contentDiv);
                chatDiv.appendChild(item);
            });
            
            // Rola para o final
            chatDiv.scrollTop = chatDiv.scrollHeight;
        }

        function bulkDeleteMessages() {
            const selectedCheckboxes = document.querySelectorAll('.bulk-delete-chat-checkbox:checked');
            
            if (selectedCheckboxes.length === 0) {
                alert('Nenhuma mensagem selecionada para exclus√£o em massa.');
                return;
            }

            if (!confirm(`Tem certeza que deseja excluir ${selectedCheckboxes.length} mensagem(ns) permanentemente? Esta a√ß√£o √© irrevers√≠vel!`)) {
                return;
            }

            const indicesToDelete = [];
            selectedCheckboxes.forEach(checkbox => {
                // O √≠ndice aqui deve ser o √≠ndice original no array 'messages', n√£o o √≠ndice filtrado
                // Esta parte precisa ser revista para garantir que pega o √≠ndice original
                // Como o renderChat filtra, √© mais seguro pegar o √≠ndice da mensagem filtrada e encontrar a original
                const filteredIndex = parseInt(checkbox.getAttribute('data-message-index'));
                const messageInQuestion = messages[filteredIndex];
                const originalIndex = messages.indexOf(messageInQuestion);
                indicesToDelete.push(originalIndex);
            });

            indicesToDelete.sort((a, b) => b - a);
            
            // Excluir os itens do array 'messages'
            indicesToDelete.forEach(index => {
                if (index >= 0 && index < messages.length) {
                    messages.splice(index, 1);
                }
            });

            saveMessages();
            alert(`Exclus√£o em massa de mensagens conclu√≠da. ${selectedCheckboxes.length} mensagem(ns) exclu√≠da(s).`);
            renderChat();
        }
        
        function toggleChatCheckboxes() {
             const checkboxes = document.querySelectorAll('.bulk-delete-chat-checkbox');
             const allChecked = Array.from(checkboxes).every(cb => cb.checked);
             checkboxes.forEach(cb => {
                 cb.checked = !allChecked;
             });
        }


        // --- Fun√ß√µes de Login, Logout e Termos ---
        // NOVO: Fun√ß√µes para Termos
        function acceptTerms() {
            localStorage.setItem('cybercraftTermsAccepted', 'true');
            document.getElementById('terms-modal').style.display = 'none';
            // Continua o login
            initializeUserView();
        }

        function declineTerms() {
            document.getElementById('terms-modal').style.display = 'none';
            logout(); // Volta para a tela de login
            alert('Para acessar o conte√∫do do Cybercraft √© necess√°rio aceitar os termos de uso e conscientiza√ß√£o.');
        }

        function developerLogin() {
            const username = document.getElementById('username').value.toLowerCase().trim();
            const password = document.getElementById('password').value.trim();

            if (DEVELOPERS[username] && DEVELOPERS[username] === password) {
                currentUser = username;
                document.getElementById('dev-name').textContent = currentUser.toUpperCase();
                
                document.getElementById('login-section').style.display = 'none';
                document.getElementById('user-view').style.display = 'none';
                document.getElementById('dev-panel').style.display = 'block';
                document.getElementById('main-logout-button').style.display = 'block';

                // Exibir painel de chat e input de resposta (Dev)
                document.getElementById('chat-panel').style.display = 'block';
                document.getElementById('user-chat-input').style.display = 'none';
                document.getElementById('dev-chat-reply').style.display = 'block';
                document.getElementById('dev-chat-controls').style.display = 'flex';
                document.getElementById('chat-bulk-actions').style.display = 'flex';
                
                changeFolder('home');
                renderChat();

                alert(`Bem-vindo, Desenvolvedor ${currentUser.toUpperCase()}!`);
            } else {
                alert('Usu√°rio ou Senha incorretos.');
            }
        }

        function userLogin() {
            const termsAccepted = localStorage.getItem('cybercraftTermsAccepted');
            
            if (termsAccepted === 'true') {
                 // Se os termos j√° foram aceitos, entra direto
                 initializeUserView();
            } else {
                 // Sen√£o, mostra o modal de termos
                 document.getElementById('terms-modal').style.display = 'block';
            }
        }
        
        function initializeUserView() {
            currentUser = 'user';
            
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('dev-panel').style.display = 'none';
            document.getElementById('user-view').style.display = 'block';
            document.getElementById('main-logout-button').style.display = 'block';

            // Ocultar controles de Dev, mostrar input de mensagem (Usu√°rio)
            document.getElementById('chat-panel').style.display = 'block';
            document.getElementById('user-chat-input').style.display = 'flex';
            document.getElementById('dev-chat-reply').style.display = 'none';
            document.getElementById('dev-chat-controls').style.display = 'none';
            document.getElementById('chat-bulk-actions').style.display = 'none';
            
            // Inicializa a view na pasta 'home'
            changeFolder('home');
            setFileTypeFilter('all'); // Reseta o filtro para o padr√£o
            renderChat();
            alert('Acesso como Usu√°rio Comum liberado.');
        }

        function logout() {
            currentUser = null;
            
            document.getElementById('login-section').style.display = 'block';
            document.getElementById('dev-panel').style.display = 'none';
            document.getElementById('user-view').style.display = 'none';
            document.getElementById('main-logout-button').style.display = 'none';
            document.getElementById('chat-panel').style.display = 'none';
            document.getElementById('user-controls').style.display = 'none';
            document.getElementById('file-type-filters').style.display = 'none';
            document.getElementById('terms-modal').style.display = 'none'; // Garante que o modal de termos seja escondido

            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            document.getElementById('search-input').value = ''; // Limpa busca
            currentFolder = 'home'; // Reset para o novo padr√£o
            fileDataUrl = null;
        }


        // --- Outras Fun√ß√µes do Desenvolvedor ---
        function addItem() {
            const name = document.getElementById('item-name').value.trim();
            const folder = document.getElementById('item-folder').value;
            const type = document.getElementById('file-type').value;
            const visible = document.getElementById('item-visible').checked;
            let url = '';

            if (type === 'link') {
                url = document.getElementById('item-url').value.trim();
                if (!url) {
                    alert('Por favor, preencha o URL do Link.');
                    return;
                }
            } else {
                url = fileDataUrl;
                if (!url) {
                    alert(`Por favor, selecione um arquivo de ${type}.`);
                    return;
                }
            }

            if (!name) {
                alert('Por favor, preencha o Nome do Item.');
                return;
            }

            // Adicionar novo item
            files.push({
                name: name,
                folder: folder,
                type: type,
                url: url,
                visible: visible,
                developer: currentUser,
                timestamp: new Date().toISOString(),
                likes: 0,
                lastEditor: currentUser // Quem criou √© o primeiro editor
            });

            saveFiles();
            
            // Limpa o formul√°rio
            document.getElementById('item-name').value = '';
            document.getElementById('item-url').value = '';
            document.getElementById('item-visible').checked = true;
            fileDataUrl = null;
            document.getElementById('file-preview-name').textContent = '';
            
            alert(`Item '${name}' adicionado com sucesso na pasta ${FOLDERS[folder]}!`);
            renderDevPanel();
        }

        // Inicializa o Quiz e os seletores de pasta ao carregar a p√°gina
        document.addEventListener('DOMContentLoaded', () => {
            updateFolderSelector('dev');
            updateFolderSelector('user');
            
            const userView = document.getElementById('user-view');
            const devPanel = document.getElementById('dev-panel');
            
            // Se j√° logado, configura a visualiza√ß√£o
            if (devPanel.style.display === 'block') {
                 document.getElementById('main-logout-button').style.display = 'block';
                 document.getElementById('dev-chat-controls').style.display = 'flex';
                 document.getElementById('chat-bulk-actions').style.display = 'flex';
                 changeFolder('home');
            } else if (userView.style.display === 'block') {
                 // Esta l√≥gica deve ser refeita para lidar com o termo ap√≥s o login,
                 // mas para o estado inicial, garanto que todos os elementos est√£o vis√≠veis.
                 document.getElementById('main-logout-button').style.display = 'block';
                 document.getElementById('user-controls').style.display = 'flex';
                 document.getElementById('file-type-filters').style.display = 'flex';
                 setFileTypeFilter('all');
                 renderUserView();
            } else {
                 changeFolder('home');
            }
        });
    </script>
</body>
</html>
