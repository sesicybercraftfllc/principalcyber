<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cybercraft</title>
    <style>
        /* PALETA DE CORES TERROSAS */
        :root {
            --cor-background: #f7f4e9; /* Bege claro / Off-White */
            --cor-principal: #6b4423;    /* Marrom Caf√© */
            --cor-secundaria: #8b5e34;  /* Marrom M√©dio */
            --cor-borda: #d4c7b2;        /* Bege acinzentado */
            --cor-texto-principal: #333;
            --cor-destaque-usuario: #4a784d; /* Verde Musgo */
            --cor-destaque-dev: #e0c29a;     /* Ocre/Bege Quente */
            --cor-erro: #cc0000; /* Cor Vermelha para Erro */
        }
        
        body {    
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;    
            margin: 0;    
            padding: 20px;
            background-color: var(--cor-background);    
            color: var(--cor-texto-principal);
        }
        .container {    
            max-width: 900px;    
            margin: 0 auto;    
            background-color: #fff;    
            padding: 30px;    
            border-radius: 12px;    
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);    
        }
        h1 {    
            text-align: center;    
            color: var(--cor-principal);    
            border-bottom: 2px solid var(--cor-borda);    
            padding-bottom: 10px;
        }
        h2, h3 { color: var(--cor-secundaria); }
        
        /* Formul√°rios e Pain√©is */
        #login-form, #dev-panel {    
            margin-top: 20px;    
            padding: 20px;    
            border: 1px solid var(--cor-borda);    
            border-radius: 8px;    
            background-color: #ffffff;
        }
        #login-form input[type="text"], #login-form input[type="password"],
        #dev-panel input[type="text"], #dev-panel select, #item-file {    
            padding: 10px;    
            margin-bottom: 12px;    
            width: 100%;    
            box-sizing: border-box;    
            border: 1px solid var(--cor-borda);
            border-radius: 4px;
        }
        /* Bot√£o de Arquivo */
        #item-file { padding: 5px; }

        /* Bot√µes */
        button {    
            padding: 10px 15px;    
            border: none;    
            border-radius: 4px;    
            cursor: pointer;    
            transition: background-color 0.3s;
        }
        
        /* Bot√£o Desenvolvedor */
        #login-form button {    
            background-color: var(--cor-principal);    
            color: white;    
            width: 100%;
        }
        #login-form button:hover { background-color: #4a2f1c; }

        /* Bot√£o Usu√°rio (M√ÅXIMO DE DESTAQUE) */
        #login-section > button {    
            background-color: var(--cor-destaque-usuario); /* Verde Musgo */
            color: white;
            width: 100%;
            margin-top: 15px;
            font-size: 1.3em; /* Mais destaque */
            padding: 18px; /* Mais preenchimento */
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3); /* Sombra mais forte */
            font-weight: bold;
        }
        #login-section > button:hover {    
            background-color: #3b603e;    
            transform: translateY(-2px); /* Efeito sutil ao passar o mouse */
        }

        /* Bot√µes Sair e A√ß√µes Dev */
        #dev-panel button, #user-view button {    
            background-color: var(--cor-secundaria);    
            color: white;
        }
        #dev-panel button:hover, #user-view button:hover { background-color: var(--cor-principal); }
        
        /* Estilo dos Links/Arquivos */
        .file-item a { color: var(--cor-principal); text-decoration: none; font-weight: bold;}
        .file-item a:hover { text-decoration: underline; }
        .dev-info { font-size: 0.85em; color: var(--cor-secundaria); margin-top: 5px; }

        /* Visualiza√ß√£o do Usu√°rio */
        #user-view h2 { color: var(--cor-destaque-usuario); }
        .file-item {    
            border: 1px solid var(--cor-borda);    
            padding: 15px;    
            margin-bottom: 10px;    
            border-radius: 6px;    
            background-color: #fffaf0;    
        }
        .file-item img, .file-item video { max-width: 100%; height: auto; border-radius: 4px; margin-top: 10px; }
        
        /* Mensagem de Conscientiza√ß√£o */
        .message {
            font-size: 1em;
            text-align: justify;
            padding: 15px;
            margin: 15px 0;
            border: 1px solid var(--cor-borda);
            border-radius: 8px;
            background-color: #ffffff;
            line-height: 1.5;
        }

        /* NOVO ESTILO: Sem√°foro da Arqueologia */
        .semaforo-container {
            display: flex;
            justify-content: space-around;
            gap: 15px;
            margin: 30px 0;
            padding: 20px 0;
            border-top: 1px solid var(--cor-secundaria);
            border-bottom: 1px solid var(--cor-secundaria);
        }
        .semaforo-item {
            width: 30%;    
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            text-align: center;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            padding: 10px;
            font-size: 1.1em;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.4);
            transition: transform 0.2s;
        }
        .semaforo-item:hover {
             transform: translateY(-3px);
        }
        .semaforo-vermelho { background-color: #cc0000; }    
        .semaforo-amarelo {    
            background-color: #ffc400;    
            color: var(--cor-principal);    
            text-shadow: none;
        }    
        .semaforo-verde { background-color: var(--cor-destaque-usuario); }    

        /* Estilos para o Quiz */
        .quiz-container {
            margin-top: 30px;
            padding: 20px;
            border: 1px solid var(--cor-secundaria);    
            border-radius: 8px;
            background-color: var(--cor-background);    
            text-align: left;
        }
        .quiz-question {
            font-weight: bold;
            color: var(--cor-principal);
            margin-bottom: 15px;
            padding-top: 15px;
            border-top: 1px dotted var(--cor-borda);
        }
        .quiz-option {
            margin-bottom: 8px;
            cursor: pointer;
            padding: 8px;
            border-radius: 4px;
            transition: background-color 0.2s;
            border: 1px solid transparent;
        }
        .quiz-option:hover {
            background-color: #e0d9c9;
        }
        .quiz-result {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 2px solid var(--cor-borda);
            font-weight: bold;
            text-align: center;
        }
        .correct { color: var(--cor-destaque-usuario); }    
        .incorrect { color: var(--cor-erro); }    

        /* Melhorias de UX no Quiz */
        .quiz-option.correct {
            background-color: #e6ffe6; /* Fundo Verde muito claro */
            border: 1px solid var(--cor-destaque-usuario);
        }
        .quiz-option.incorrect {
            background-color: #ffe6e6; /* Fundo Vermelho muito claro */
            border: 1px solid var(--cor-erro);
        }
        .quiz-option.correct:hover, .quiz-option.incorrect:hover {
            background-color: initial; 
        }

        /* Painel do Desenvolvedor */
        .dev-item {    
            display: flex;    
            justify-content: space-between;    
            align-items: center;    
            border: 1px solid var(--cor-destaque-dev);    
            padding: 10px;    
            margin-bottom: 10px;    
            border-radius: 6px;    
            background-color: var(--cor-destaque-dev);    
            color: var(--cor-principal);
        }
        .dev-item span strong { color: var(--cor-principal); }
        .dev-item > span { width: 70%; }    

        .folder-selector { margin-bottom: 20px; }
        .folder-selector button {
            background-color: var(--cor-borda);
            color: var(--cor-texto-principal);
            margin-right: 5px;
        }
        .folder-selector button.active {
            background-color: var(--cor-principal);
            color: white;
            font-weight: bold;
        }
        
        /* Estilos para a nova tela de V√≠deos */
        #videos-screen {
            padding: 20px;
            border: 1px solid var(--cor-destaque-usuario);
            border-radius: 8px;
            background-color: #ffffff;
            margin-top: 20px;
        }

        /* Estilo para v√≠deos externos */
        .video-item a {
            display: block; 
            padding: 10px; 
            background-color: #f0f0f0; 
            border-radius: 4px; 
            border: 1px solid var(--cor-borda); 
            margin-bottom: 10px; 
            text-align: center;
            font-weight: bold;
        }

    </style>
</head>
<body>

    <div class="container">
        <h1>Cybercraft</h1>

        <div id="login-section">
            <button onclick="userLogin()" style="margin-bottom: 25px;">
                <span style="font-size: 1.3em; margin-right: 10px;">üìö</span> Acessar Como Usuario Comum
            </button>
            
            <p style="text-align: center; margin-bottom: 20px;">
                Ou
            </p>

            <div id="login-form">
                <h3>Login do Desenvolvedor</h3>
                <input type="text" id="username" placeholder="Usu√°rio">
                <input type="password" id="password" placeholder="Senha">
                <button onclick="developerLogin()">Entrar como Desenvolvedor</button>
            </div>
        </div>

        <div id="dev-panel" style="display: none;">
            <h2>Painel do Desenvolvedor (<span id="dev-name"></span>)</h2>
            
            <h3>Adicionar Novo Item</h3>
            <label for="item-folder">Pasta:</label>
            <select id="item-folder">
                <option value="projetos">Projetos</option>
                <option value="documentacao">Documenta√ß√£o</option>
                <option value="tutoriais">Tutoriais</option>
                <option value="midia">M√≠dia</option>
                <option value="diversos">Diversos</option>
                <option value="conscientizacao">Conscientiza√ß√£o</option>
            </select><br><br>
            
            <label for="file-type">Tipo:</label>
            <select id="file-type" onchange="toggleInputType()">
                <option value="link">Link</option>
                <option value="foto">Foto</option>
                <option value="video">V√≠deo</option>
            </select><br><br>
            
            <label for="item-name">Nome do Item:</label>
            <input type="text" id="item-name" placeholder="Ex: Relat√≥rio Final" style="width: 100%; margin-bottom: 10px;"><br>
            
            <div id="dynamic-input-container">
                <label for="item-url">URL (Link):</label>
                <input type="text" id="item-url" placeholder="http://recurso.com/link" style="width: 100%; margin-bottom: 10px;">
            </div>
            
            <label>Vis√≠vel para Usu√°rio?</label>
            <input type="checkbox" id="item-visible" checked><br><br>
            
            <button onclick="addItem()">Adicionar Item</button>

            <hr>

            <h3>Arquivos Gerenci√°veis por Pasta</h3>
            <div class="folder-selector" id="dev-folder-selector">
                </div>
            <div id="dev-file-list">
                </div>
            <button onclick="logout()">Sair</button>
        </div>

        <div id="user-view" style="display: none;">
            <h2>Visualiza√ß√£o do Usu√°rio</h2>
            <div class="folder-selector" id="user-folder-selector">
                </div>
            
            <div id="user-file-list">
                </div>

            <div id="videos-screen" style="display: none;">
                <button onclick="changeView('conscientizacao_quiz')" style="margin-bottom: 20px; background-color: var(--cor-principal);">
                    ‚Üê Voltar ao Quiz e Sem√°foro
                </button>
                <h3 style="color: var(--cor-destaque-usuario);">‚ñ∂Ô∏è V√≠deos Educativos: Guia de Arqueologia em Casa</h3>
                <p>Assista aos v√≠deos para aprender como ser um Guardi√£o da Hist√≥ria e preservar o patrim√¥nio!</p>
                <hr>
                <div id="videos-list-content">
                    </div>
            </div>

            <button onclick="logout()">Sair</button>
        </div>
    </div>

    <script>
        // --- Configura√ß√µes ---
        const DEVELOPERS = {
            "dev01": "123", "dev02": "456", "dev03": "789",    
            "dev04": "101", "dev04": "112", "dev06": "131",    
            "dev07": "415", "dev08": "161"
        };
        const FOLDERS = {
            "projetos": "Projetos", "documentacao": "Documenta√ß√£o", "tutoriais": "Tutoriais",    
            "midia": "M√≠dia", "diversos": "Diversos",
            "conscientizacao": "Conscientiza√ß√£o"
        };
        
        let files = JSON.parse(localStorage.getItem('files')) || [];
        let currentUser = null;    
        let currentFolder = 'projetos';    
        let fileDataUrl = null;    

        // --- Fun√ß√µes Auxiliares ---

        function saveFiles() {
            localStorage.setItem('files', JSON.stringify(files));
        }

        function toggleInputType() {
            const type = document.getElementById('file-type').value;
            const container = document.getElementById('dynamic-input-container');
            
            if (type === 'link') {
                container.innerHTML = `
                    <label for="item-url">URL (Link):</label>
                    <input type="text" id="item-url" placeholder="http://recurso.com/link" style="width: 100%; margin-bottom: 10px;">
                `;
            } else {
                let acceptType = type === 'foto' ? 'image/*' : 'video/*';
                container.innerHTML = `
                    <label for="item-file">Carregar ${type.charAt(0).toUpperCase() + type.slice(1)}:</label>
                    <input type="file" id="item-file" accept="${acceptType}" onchange="handleFileUpload(event, '${type}')">
                `;
                fileDataUrl = null;    
            }
        }
        
        function handleFileUpload(event, type) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                fileDataUrl = e.target.result;    
                alert(`Arquivo (${type}) carregado com sucesso!`);
            };
            reader.readAsDataURL(file);
        }
        
        // NOVO: Fun√ß√£o para alternar entre as views de usu√°rio
        function changeView(viewType) {
            const userFileList = document.getElementById('user-file-list');
            const videosScreen = document.getElementById('videos-screen');

            if (viewType === 'conscientizacao_quiz') {
                userFileList.style.display = 'block';
                videosScreen.style.display = 'none';
                // Certifica-se de que o quiz est√° carregado quando volta
                loadQuiz(); 
            } else if (viewType === 'educational_videos') {
                userFileList.style.display = 'none';
                videosScreen.style.display = 'block';
                // Carrega os v√≠deos quando muda para esta tela
                loadEducationalVideos(); 
            } else {
                // Para outras pastas normais (projetos, tutoriais, etc.)
                userFileList.style.display = 'block';
                videosScreen.style.display = 'none';
            }
        }

        function changeFolder(folderKey) {
            currentFolder = folderKey;
            updateFolderSelector('dev');
            updateFolderSelector('user');
            
            if (document.getElementById('dev-panel').style.display === 'block') {
                renderDevPanel();
            } else if (document.getElementById('user-view').style.display === 'block') {
                renderUserView();
            }
            // Garante que, ao mudar de pasta, a tela de v√≠deos √© escondida
            if(currentUser === 'user') {
                changeView(folderKey === 'conscientizacao' ? 'conscientizacao_quiz' : 'default');
            }
        }

        function updateFolderSelector(view) {
            const selectorDiv = document.getElementById(`${view}-folder-selector`);
            selectorDiv.innerHTML = '';
            for (const key in FOLDERS) {
                const button = document.createElement('button');
                button.textContent = FOLDERS[key];
                button.setAttribute('onclick', `changeFolder('${key}')`);
                if (key === currentFolder) {
                    button.classList.add('active');
                }
                selectorDiv.appendChild(button);
            }
        }

        // --- Renderiza√ß√£o ---

        function renderDevPanel() {
            const devList = document.getElementById('dev-file-list');
            devList.innerHTML = '';
            
            const filesInFolder = files.filter(file => file.folder === currentFolder);

            if (filesInFolder.length === 0) {
                devList.innerHTML = `<p>Nenhum item na pasta "${FOLDERS[currentFolder]}" para gerenciar.</p>`;
                return;
            }
            
            filesInFolder.forEach(file => {
                const item = document.createElement('div');
                item.className = 'dev-item';
                
                const originalIndex = files.findIndex(f =>    
                    f.name === file.name &&    
                    f.url === file.url &&    
                    f.developer === file.developer &&    
                    f.folder === file.folder
                );

                const visibilityText = file.visible ? 'Vis√≠vel' : 'Oculto';
                
                item.innerHTML = `
                    <span>
                        <strong>[${file.type.toUpperCase()}]</strong> ${file.name}<br>
                        <span class="dev-info">Adicionado por: ${file.developer.toUpperCase()}</span> - *${visibilityText}*
                    </span>
                    <div>
                        <button onclick="toggleVisibility(${originalIndex})">${file.visible ? 'Ocultar' : 'Tornar Vis√≠vel'}</button>
                        <button onclick="deleteItem(${originalIndex})">Excluir</button>
                    </div>
                `;
                devList.appendChild(item);
            });
        }

        // FUN√á√ÉO RENDERUSERVIEW (INCLUI SEM√ÅFORO, BOT√ÉO DE V√çDEOS E QUIZ)
        function renderUserView() {
            const userList = document.getElementById('user-file-list');
            userList.innerHTML = '';
            
            const visibleFiles = files.filter(file => file.visible && file.folder === currentFolder);

            if (visibleFiles.length === 0) {
                userList.innerHTML = `<p>Nenhum arquivo ou link vis√≠vel na pasta "${FOLDERS[currentFolder]}".</p>`;
                // Se n√£o h√° arquivos e n√£o √© a pasta de conscientiza√ß√£o, esconde a tela de v√≠deos
                if (currentFolder !== 'conscientizacao') {
                    document.getElementById('videos-screen').style.display = 'none';
                }
                return;
            }
            
            visibleFiles.forEach(file => {
                const item = document.createElement('div');
                item.className = 'file-item';
                
                let contentHTML = `
                    <p>
                        <strong>[${file.type.toUpperCase()}]</strong> ${file.name}<br>
                        <span class="dev-info">Adicionado por: ${file.developer.toUpperCase()}</span>
                    </p>
                `;
                
                // RENDERIZA√á√ÉO DA TELA DE CONSCIENTIZA√á√ÉO, SEM√ÅFORO, BOT√ÉO DE V√çDEOS E O QUIZ
                if (file.folder === 'conscientizacao' && file.name.includes("Guardi√µes da Hist√≥ria")) {
                    contentHTML = `
                        <h2 style="color: var(--cor-principal); border-bottom: 2px solid var(--cor-borda); padding-bottom: 5px;">Conscientiza√ß√£o</h2>
                        <p class="dev-info" style="text-align: center;">Conte√∫do em desenvolvimento</p>
                        <div class="message">
                            A Hist√≥ria de Salto est√° em suas m√£os. Voc√™ est√° pronto para proteg√™-la?
                            
                            Somos a equipe SESI Cybercraft e nosso Projeto de Inova√ß√£o "Guardi√µes da Hist√≥ria: Arqueologia em A√ß√£o" nasceu de uma miss√£o simples: reconectar Salto com seu pr√≥prio passado.

                            Sua crian√ßa participou da nossa oficina e agora √© uma **Guardi√£ do Passado!** Aqui, voc√™ encontra o **Guia Completo da Arqueologia em Casa** com v√≠deos r√°pidos, o Quiz de Conscientiza√ß√£o e a Regra de Ouro para preservar o patrim√¥nio.
                        </div>

                        <h3 style="text-align: center; color: var(--cor-principal); margin-top: 40px;">‚ö†Ô∏è Regra de Ouro: Sem√°foro do S√≠tio ‚ö†Ô∏è</h3>
                        <div class="semaforo-container">
                            <div class="semaforo-item semaforo-vermelho">
                                üõë VERMELHO: N√ÉO TOQUE
                            </div>
                            <div class="semaforo-item semaforo-amarelo">
                                üì∏ AMARELO: FOTOGRAFE
                            </div>
                            <div class="semaforo-item semaforo-verde">
                                üìû VERDE: LIGUE (e avise as autoridades)
                            </div>
                        </div>

                        <button 
                            onclick="changeView('educational_videos')" 
                            id="toggle-videos-button" 
                            style="width: 100%; padding: 15px; margin-bottom: 30px; background-color: var(--cor-secundaria); color: white; font-size: 1.1em;"
                        >
                            ‚ñ∂Ô∏è Ver V√≠deos Educativos
                        </button>

                        <div class="quiz-container">
                            <h3>Quiz: Guardi√µes Da Historia </h3>
                            <div id="quiz-content">
                                </div>
                            <div class="quiz-result" id="quiz-result"></div>
                        </div>
                    `;
                    // Assegura que o Quiz seja carregado depois que o HTML for renderizado
                    setTimeout(() => {
                        loadQuiz();
                    }, 0); 
                }    
                // Renderiza√ß√£o normal para outros arquivos
                else if (file.type === 'link' || file.type === 'foto') {
                    contentHTML += `<a href="${file.url}" target="_blank">`;
                    if (file.type === 'link') {
                        contentHTML += `Acessar Recurso`;
                    } else if (file.type === 'foto') {
                        if (file.url.startsWith('data:image')) {
                            contentHTML += `<img src="${file.url}" alt="${file.name}">`;
                        } else {
                            contentHTML += `Visualizar Foto (Link Externo)`;
                        }
                    }
                    contentHTML += `</a>`;
                } else if (file.type === 'video') {
                    if (file.url.startsWith('data:video')) {
                        contentHTML += `<video controls src="${file.url}"></video>`;
                    } else {
                        contentHTML += `<a href="${file.url}" target="_blank">Assistir V√≠deo (Link Externo)</a>`;
                    }
                }
                
                item.innerHTML = contentHTML;
                userList.appendChild(item);
            });
        }


        // --- Fun√ß√µes de A√ß√£o (Desenvolvedor) ---

        function addItem() {
            const name = document.getElementById('item-name').value.trim();
            const type = document.getElementById('file-type').value;
            const folder = document.getElementById('item-folder').value;    
            const visible = document.getElementById('item-visible').checked;
            
            let url;

            if (type === 'link') {
                url = document.getElementById('item-url').value.trim();
            } else {
                url = fileDataUrl;    
            }

            if (name === '' || !url) {
                alert(`Por favor, preencha o nome e ${type === 'link' ? 'a URL' : 'carregue o arquivo'}.`);
                return;
            }

            files.push({
                name: name,
                url: url,    
                type: type,
                folder: folder,    
                visible: visible,
                developer: currentUser    
            });

            saveFiles();
            
            changeFolder(folder);    
            
            document.getElementById('item-name').value = '';
            if (type === 'link') {
                document.getElementById('item-url').value = '';
            }
            document.getElementById('item-visible').checked = true;
            fileDataUrl = null;    
            toggleInputType();    

            alert(`Item adicionado com sucesso na pasta ${FOLDERS[folder]}!`);
        }
        
        function toggleVisibility(index) {
            files[index].visible = !files[index].visible;
            saveFiles();
            renderDevPanel();    
        }

        function deleteItem(index) {
            if (confirm(`Tem certeza que deseja excluir o item: ${files[index].name}?`)) {
                files.splice(index, 1);
                saveFiles();
                renderDevPanel();
                alert('Item exclu√≠do.');
            }
        }

        function developerLogin() {
            const username = document.getElementById('username').value.toLowerCase().trim();
            const password = document.getElementById('password').value.trim();

            if (DEVELOPERS[username] && DEVELOPERS[username] === password) {
                currentUser = username;
                document.getElementById('dev-name').textContent = currentUser.toUpperCase();
                
                document.getElementById('login-section').style.display = 'none';
                document.getElementById('user-view').style.display = 'none';
                document.getElementById('dev-panel').style.display = 'block';
                
                toggleInputType();
                changeFolder('projetos'); // Volta para a pasta padr√£o do dev
            } else {
                alert('Credenciais de Desenvolvedor Inv√°lidas.');
            }
        }

        function userLogin() {
            currentUser = 'user';
            
            document.getElementById('login-section').style.display = 'none';
            document.getElementById('dev-panel').style.display = 'none';
            document.getElementById('user-view').style.display = 'block';
            
            // ALTERA√á√ÉO CHAVE: Vai direto para a pasta 'conscientizacao'
            changeFolder('conscientizacao');
        }

        function logout() {
            currentUser = null;
            document.getElementById('login-section').style.display = 'block';
            document.getElementById('dev-panel').style.display = 'none';
            document.getElementById('user-view').style.display = 'none';

            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            
            currentFolder = 'projetos';    
            fileDataUrl = null;    
        }

        // ------------------------------------------------------------------
        // --- Fun√ß√µes do Quiz de Arqueologia (Uma Pergunta por Vez) ---

        const QUIZ_QUESTIONS = [
            {
                question: "1. Qual √© o trabalho principal do arque√≥logo?",
                options: ["A) Construir casas.", "B) Estudar coisas antigas que os humanos deixaram (como panelas e ferramentas).", "C) Cuidar de animais na floresta."],
                answerIndex: 1    
            },
            {
                question: "2. O que s√£o os 'vest√≠gios' que o arque√≥logo procura?",
                options: ["A) Peda√ßos de gelo.", "B) Coisas que contam a hist√≥ria das pessoas, como ossos, pinturas e objetos.", "C) Frutas da esta√ß√£o."],
                answerIndex: 1
            },
            {
                question: "3. Como chamamos o lugar onde os arque√≥logos fazem escava√ß√µes para encontrar objetos?",
                options: ["A) Pra√ßa de alimenta√ß√£o.", "B) S√≠tio Arqueol√≥gico.", "C) Campo de futebol."],
                answerIndex: 1
            },
            {
                question: "4. Se voc√™ achar uma ponta de flecha muito antiga, isso √© um tipo de qu√™?",
                options: ["A) Um lixo moderno.", "B) Um brinquedo novo.", "C) Um artefato (um objeto feito por humanos no passado)."],
                answerIndex: 2
            },
            {
                question: "5. Que ferramenta o arque√≥logo usa para cavar com muito cuidado?",
                options: ["A) Um trator grande.", "B) Pinc√©is pequenos e colheres.", "C) Uma m√°quina de lavar."],
                answerIndex: 1
            }
        ];

        let currentQuestionIndex = 0; // Controla a pergunta atual
        let correctAnswers = 0;
        let quizFinished = false;    

        function loadQuiz() {
            currentQuestionIndex = 0;
            correctAnswers = 0;
            quizFinished = false;
            renderQuestion();
            document.getElementById('quiz-result').textContent = 'Responda as 5 perguntas!';
        }

        function renderQuestion() {
            const quizDiv = document.getElementById('quiz-content');
            if (!quizDiv) return;

            if (quizFinished) {
                // Se terminou, exibe apenas a mensagem final
                quizDiv.innerHTML = '<p>Quiz Finalizado! Role para baixo e veja seu resultado.</p>';
                return;
            }

            const q = QUIZ_QUESTIONS[currentQuestionIndex];
            quizDiv.innerHTML = '';    

            const questionDiv = document.createElement('div');
            questionDiv.className = 'quiz-question';
            questionDiv.innerHTML = q.question;
            
            q.options.forEach((option, oIndex) => {
                const optionDiv = document.createElement('div');
                optionDiv.className = 'quiz-option';
                optionDiv.textContent = option;
                optionDiv.onclick = () => checkAnswer(oIndex, optionDiv);    
                questionDiv.appendChild(optionDiv);
            });

            quizDiv.appendChild(questionDiv);
            document.getElementById('quiz-result').textContent = `Pergunta ${currentQuestionIndex + 1} de ${QUIZ_QUESTIONS.length}`;
        }

        function checkAnswer(selectedIndex, element) {
            const q = QUIZ_QUESTIONS[currentQuestionIndex];
            const isCorrect = selectedIndex === q.answerIndex;

            // Desabilita todas as op√ß√µes de clique para esta pergunta
            Array.from(element.parentElement.querySelectorAll('.quiz-option')).forEach(opt => {
                opt.onclick = null;
                opt.style.cursor = 'default';
                opt.style.backgroundColor = 'transparent';
            });

            // Marca a correta e a incorreta
            Array.from(element.parentElement.querySelectorAll('.quiz-option')).forEach((opt, idx) => {
                if (idx === q.answerIndex) {
                    opt.classList.add('correct');
                    opt.style.fontWeight = 'bold';
                } else if (idx === selectedIndex && !isCorrect) {
                    opt.classList.add('incorrect');
                }
            });

            if (isCorrect) {
                correctAnswers++;
            }

            // Adiciona um bot√£o para ir para a pr√≥xima pergunta ap√≥s a resposta
            const nextButton = document.createElement('button');
            nextButton.textContent = currentQuestionIndex < QUIZ_QUESTIONS.length - 1 ? 'Pr√≥xima Pergunta ‚Üí' : 'Ver Resultado Final';
            nextButton.style.marginTop = '20px';
            nextButton.style.padding = '10px 20px';
            nextButton.style.backgroundColor = 'var(--cor-destaque-usuario)';
            nextButton.style.color = 'white';
            nextButton.onclick = moveToNextQuestion;

            element.parentElement.appendChild(nextButton);

            // Atualiza o placar provis√≥rio no resultado
            document.getElementById('quiz-result').innerHTML += `<br> <span class="${isCorrect ? 'correct' : 'incorrect'}">${isCorrect ? 'Correto!' : 'Errado!'}</span>`;
        }

        function moveToNextQuestion() {
            currentQuestionIndex++;
            
            if (currentQuestionIndex < QUIZ_QUESTIONS.length) {
                renderQuestion();
            } else {
                quizFinished = true;
                renderQuestion(); // Renderiza a mensagem final
                updateQuizResult();
            }
        }

        function updateQuizResult() {
            const resultDiv = document.getElementById('quiz-result');
            resultDiv.innerHTML = `
                <h3 style="color: var(--cor-principal);"> QUIZ FINALIZADO! </h3>
                Resultado Final: <span class="${correctAnswers >= 3 ? 'correct' : 'incorrect'}">${correctAnswers} de ${QUIZ_QUESTIONS.length} acertos!</span>
                <button onclick="loadQuiz()" style="margin-top: 15px; background-color: var(--cor-secundaria);">Tentar Novamente</button>
            `;
        }
        
        // --- Fun√ß√µes para V√≠deos Educativos ---

        function loadEducationalVideos() {
            const videoListDiv = document.getElementById('videos-list-content');
            if (!videoListDiv) return;

            // Filtra apenas v√≠deos vis√≠veis na pasta 'tutoriais'
            const educationalVideos = files.filter(file => file.visible && file.folder === 'tutoriais' && file.type === 'video');

            if (educationalVideos.length === 0) {
                videoListDiv.innerHTML = '<p style="padding: 20px; text-align: center; border: 1px dashed var(--cor-borda);"> ERRO:Nenhum v√≠deo educativo vis√≠vel no momento. Volte mais tarde e tente novamente.</p>';
                return;
            }

            videoListDiv.innerHTML = '';
            educationalVideos.forEach(video => {
                const videoItem = document.createElement('div');
                videoItem.className = 'video-item';
                videoItem.style.marginBottom = '20px';
                
                let contentHtml = '';
                if (video.url.startsWith('data:video')) {
                     // Se for um v√≠deo carregado via dataURL, exibe o player
                    contentHtml = `<p><strong>${video.name}</strong></p><video controls src="${video.url}" style="max-width: 100%; border-radius: 4px;"></video>`;
                } else {
                    // Se for link externo (Youtube, Vimeo, etc.)
                    contentHtml = `<a href="${video.url}" target="_blank">
                                    ‚ñ∂Ô∏è ${video.name} (Assistir V√≠deo Externo) 
                                </a>`;
                }
                videoItem.innerHTML = contentHtml;
                videoListDiv.appendChild(videoItem);
            });
        }

        // ------------------------------------------------------------------

        // Inicializa a p√°gina
        function init() {
            // 1. Garante que os arquivos iniciais existam (se for a primeira visita)
            if (files.length === 0) {
                files.push({
                    name: "Guardi√µes da Hist√≥ria (Arqueologia em A√ß√£o)",
                    url: "#", 
                    type: "link",
                    folder: "conscientizacao", 
                    visible: true,
                    developer: "dev01"
                });
                saveFiles(); 
            }

            // 2. Garante o estado inicial (como se tivesse feito logout)
            logout();
            
            // 3. Garante que o painel de adicionar itens do Dev esteja no estado Link
            toggleInputType();
        }

        init();
    </script>
</body>
</html>
